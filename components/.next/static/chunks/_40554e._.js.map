{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["turbopack://[project]/hooks/useWebRTC.ts"],"sourcesContent":["import { useEffect, useRef, useState, useCallback } from 'react';\nimport { io, Socket } from 'socket.io-client';\nimport SimplePeer from 'simple-peer';\n\ninterface UseWebRTCProps {\n  userId: string;\n  conversationId: string;\n  otherUserId: string;\n}\n\ninterface CallState {\n  remoteStream: MediaStream | null;\n  localStream: MediaStream | null;\n  callStatus: 'idle' | 'calling' | 'ringing' | 'connected' | 'ended';\n  callType: 'voice' | 'video' | null;\n  isMuted: boolean;\n  isVideoEnabled: boolean;\n}\n\nconst ICE_SERVERS = {\n  iceServers: [\n    { urls: 'stun:stun.l.google.com:19302' },\n    { urls: 'stun:stun1.l.google.com:19302' },\n  ],\n};\n\nexport const useWebRTC = ({ userId, conversationId, otherUserId }: UseWebRTCProps) => {\n  const [callState, setCallState] = useState<CallState>({\n    remoteStream: null,\n    localStream: null,\n    callStatus: 'idle',\n    callType: null,\n    isMuted: false,\n    isVideoEnabled: true,\n  });\n\n  const socketRef = useRef<Socket | null>(null);\n  const peerRef = useRef<SimplePeer.Instance | null>(null);\n  const localStreamRef = useRef<MediaStream | null>(null);\n  const remoteSocketIdRef = useRef<string | null>(null);\n  const incomingOfferRef = useRef<SimplePeer.SignalData | null>(null);\n\n  const endCallCleanup = useCallback(() => {\n    if (peerRef.current) {\n      peerRef.current.destroy();\n      peerRef.current = null;\n    }\n    if (localStreamRef.current) {\n      localStreamRef.current.getTracks().forEach(track => track.stop());\n      localStreamRef.current = null;\n    }\n    setCallState({\n      remoteStream: null,\n      localStream: null,\n      callStatus: 'idle',\n      callType: null,\n      isMuted: false,\n      isVideoEnabled: true,\n    });\n    remoteSocketIdRef.current = null;\n    incomingOfferRef.current = null;\n  }, []);\n\n  useEffect(() => {\n    const signalingUrl = process.env.NEXT_PUBLIC_SIGNALING_SERVER_URL || 'http://localhost:3002';\n    const signalingPath = process.env.NEXT_PUBLIC_SIGNALING_SOCKET_PATH || '/socket.io';\n    const socket = io(signalingUrl, {\n      path: signalingPath,\n      transports: ['websocket'],\n      reconnection: true,\n    });\n    socketRef.current = socket;\n\n    socket.on('connect', () => {\n      console.log('üîå Conectado ao servidor de sinaliza√ß√£o com ID:', socket.id);\n      socket.emit('register', { userId, conversationId });\n    });\n\n    // Servidor confirma que a chamada foi iniciada e envia o socketId do destinat√°rio\n    socket.on('call-initiated', ({ toSocketId }) => {\n      console.log('üìû Chamada iniciada. Destinat√°rio socket ID:', toSocketId);\n      remoteSocketIdRef.current = toSocketId;\n    });\n\n    // Recebendo uma chamada\n    socket.on('incoming-call', ({ from, offer, callType }) => {\n      console.log('Incoming call from', from);\n      remoteSocketIdRef.current = from;\n      incomingOfferRef.current = offer;\n      setCallState(prev => ({ ...prev, callStatus: 'ringing', callType }));\n    });\n\n    // A outra parte atendeu\n    socket.on('call-answered', ({ from, answer }) => {\n      console.log('Call answered by', from);\n      remoteSocketIdRef.current = from;\n      peerRef.current?.signal(answer);\n    });\n\n    // A outra parte enviou um sinal (ICE candidate)\n    socket.on('ice-candidate', ({ candidate }) => {\n      peerRef.current?.signal(candidate);\n    });\n\n    // A outra parte desligou\n    socket.on('call-ended', () => {\n      console.log('Chamada encerrada pela outra parte.');\n      endCallCleanup();\n    });\n    \n    // O usu√°rio chamado n√£o est√° dispon√≠vel\n    socket.on('user-unavailable', () => {\n      console.log('Usu√°rio chamado n√£o est√° dispon√≠vel.');\n      endCallCleanup();\n    });\n\n    return () => {\n      socket.disconnect();\n      endCallCleanup();\n    };\n  }, [userId, conversationId, endCallCleanup]);\n\n  const createPeer = (stream: MediaStream, initiator: boolean) => {\n    const peer = new SimplePeer({\n      initiator,\n      stream,\n      config: ICE_SERVERS,\n      trickle: true,\n    });\n\n    peer.on('signal', (signal) => {\n      if (initiator && signal.type === 'offer') {\n        console.log('Enviando oferta...');\n        socketRef.current?.emit('call-user', { to: otherUserId, offer: signal, callType: callState.callType });\n      } else if (!initiator && signal.type === 'answer') {\n        console.log('Enviando resposta...');\n        socketRef.current?.emit('answer-call', { to: remoteSocketIdRef.current, answer: signal });\n      } else {\n        // Enviar ICE candidates\n        socketRef.current?.emit('ice-candidate', { to: remoteSocketIdRef.current, candidate: signal });\n      }\n    });\n\n    peer.on('stream', (remoteStream) => {\n      console.log('üé• Stream remoto recebido');\n      setCallState(prev => ({ ...prev, remoteStream, callStatus: 'connected' }));\n    });\n\n    peer.on('error', (err) => console.error('‚ùå Erro no peer:', err));\n    peer.on('close', () => endCallCleanup());\n\n    peerRef.current = peer;\n    return peer;\n  };\n\n  const startCall = useCallback(async (type: 'voice' | 'video') => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: type === 'video',\n        audio: true,\n      });\n      localStreamRef.current = stream;\n      setCallState(prev => ({ ...prev, localStream: stream, callStatus: 'calling', callType: type }));\n      createPeer(stream, true);\n      return true;\n    } catch (error) {\n      console.error('Erro ao iniciar chamada:', error);\n      return false;\n    }\n  }, [otherUserId]);\n\n  const acceptCall = useCallback(async (type?: 'voice' | 'video', offer?: SimplePeer.SignalData) => {\n    const callTypeToUse = type || callState.callType || 'voice';\n    const offerToUse = offer || incomingOfferRef.current;\n\n    if (!offerToUse) {\n      console.error('Nenhuma oferta para aceitar');\n      return false;\n    }\n\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: callTypeToUse === 'video',\n        audio: true,\n      });\n      localStreamRef.current = stream;\n      setCallState(prev => ({ ...prev, localStream: stream, callStatus: 'connected', callType: callTypeToUse }));\n      const peer = createPeer(stream, false);\n      peer.signal(offerToUse);\n      return true;\n    } catch (error) {\n      console.error('Erro ao aceitar chamada:', error);\n      return false;\n    }\n  }, [callState.callType]);\n\n  const endCall = useCallback(() => {\n    socketRef.current?.emit('end-call', { to: remoteSocketIdRef.current });\n    endCallCleanup();\n  }, [endCallCleanup]);\n\n  const toggleMute = useCallback(() => {\n    if (localStreamRef.current) {\n      const audioTrack = localStreamRef.current.getAudioTracks()[0];\n      audioTrack.enabled = !audioTrack.enabled;\n      setCallState(prev => ({ ...prev, isMuted: !audioTrack.enabled }));\n    }\n  }, []);\n\n  const toggleVideo = useCallback(() => {\n    if (localStreamRef.current) {\n      const videoTrack = localStreamRef.current.getVideoTracks()[0];\n      if (videoTrack) {\n        videoTrack.enabled = !videoTrack.enabled;\n        setCallState(prev => ({ ...prev, isVideoEnabled: videoTrack.enabled }));\n      }\n    }\n  }, []);\n\n  return { callState, startCall, acceptCall, endCall, toggleMute, toggleVideo };\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 263, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 269, "column": 0}, "map": {"version":3,"sources":["turbopack://[project]/app/mensagens/[id]/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState, useRef } from 'react';\nimport { useParams, useRouter } from 'next/navigation';\nimport { ArrowLeft, Send, RefreshCw, User, Clock, MessageSquare, Paperclip, Check, CheckCheck, MoreVertical, Phone, Video, Info, Image, Smile, Circle } from 'lucide-react';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { useWebRTC } from '@/hooks/useWebRTC';\nimport { supabase } from '@/lib/supabase-client';\nimport DOMPurify from 'dompurify';\n\ninterface Attachment {\n  type: 'image' | 'file';\n  url: string;\n  name: string;\n  size: number;\n  mimeType: string;\n}\n\ninterface Message {\n  id: string;\n  conversationId: string;\n  senderId: string;\n  senderName: string;\n  receiverId: string;\n  text: string;\n  createdAt: string;\n  read: boolean;\n  attachments?: Attachment[];\n  deletedBy?: string[];\n  deletedForEveryone?: boolean;\n  deletedForEveryoneAt?: string | null;\n}\n\ninterface Conversation {\n  id: string;\n  participants: string[];\n  participantNames: Record<string, string>;\n  lastMessage?: string;\n  unreadCount: Record<string, number>;\n  onlineStatus?: Record<string, boolean>;\n  createdAt?: string;\n}\n\nexport default function ChatPage() {\n  const params = useParams<{ id: string }>();\n  const router = useRouter();\n  const { user } = useAuth();\n  const conversationId = params?.id;\n\n  const currentUserId = user?.uid || '';\n  const currentUserName = user?.displayName || 'Usu√°rio';\n\n  const [conversation, setConversation] = useState<Conversation | null>(null);\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [messageText, setMessageText] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [sending, setSending] = useState(false);\n  const [showEmojiPicker, setShowEmojiPicker] = useState(false);\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\n  const [filePreview, setFilePreview] = useState<string | null>(null);\n  const [uploading, setUploading] = useState(false);\n\n  // Estados para menu de contexto e exclus√£o\n  const [contextMenu, setContextMenu] = useState<{ x: number; y: number; messageId: string; createdAt: string; isSender: boolean } | null>(null);\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\n  const [messageToDelete, setMessageToDelete] = useState<string | null>(null);\n  const [deleteForEveryone, setDeleteForEveryone] = useState(false);\n\n  // Estados para funcionalidades do header\n  const [showInfoModal, setShowInfoModal] = useState(false);\n  const [showMoreMenu, setShowMoreMenu] = useState(false);\n  const [showVoiceCallModal, setShowVoiceCallModal] = useState(false);\n  const [showVideoCallModal, setShowVideoCallModal] = useState(false);\n  const [isInCall, setIsInCall] = useState(false);\n  const [callDuration, setCallDuration] = useState(0);\n\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const imageInputRef = useRef<HTMLInputElement>(null);\n  const localVideoRef = useRef<HTMLVideoElement>(null);\n  const remoteVideoRef = useRef<HTMLVideoElement>(null);\n  const remoteAudioRef = useRef<HTMLAudioElement>(null);\n\n  // WebRTC Hook\n  const otherUserId = conversation?.participants.find(p => p !== currentUserId) || '';\n  const {\n    callState,\n    startCall,\n    acceptCall,\n    endCall: endWebRTCCall,\n    toggleMute,\n    toggleVideo,\n  } = useWebRTC({\n    userId: currentUserId,\n    conversationId: conversationId || '',\n    otherUserId,\n  });\n\n  // Effect para conectar √°udio remoto (chamadas de voz)\n  useEffect(() => {\n    if (remoteAudioRef.current && callState.remoteStream) {\n      console.log('üîä Conectando stream de √°udio remoto');\n      remoteAudioRef.current.srcObject = callState.remoteStream;\n    }\n  }, [callState.remoteStream]);\n\n  const fetchData = async () => {\n    if (!conversationId) return;\n    try {\n      const url = currentUserId\n        ? `/api/mensagens/${conversationId}?userId=${currentUserId}`\n        : `/api/mensagens/${conversationId}`;\n\n      console.log('üîÑ DEBUG: Buscando mensagens com URL:', url);\n      const res = await fetch(url, { cache: 'no-store' });\n      if (!res.ok) throw new Error('Falha');\n      const json = await res.json();\n      console.log('üîÑ DEBUG: Mensagens recebidas:', json.messages?.length || 0);\n\n      console.log('üîç DEBUG - Conversa individual:', {\n        conversationId,\n        onlineStatus: json.conversation?.onlineStatus,\n        participants: json.conversation?.participants,\n        currentUserId\n      });\n\n      setConversation(json.conversation);\n      setMessages(json.messages || []);\n      try {\n        const unreadCount = json?.conversation?.unreadCount?.[currentUserId] || 0;\n        if (currentUserId && unreadCount > 0) {\n          await fetch(`/api/mensagens/${conversationId}`, {\n            method: 'PATCH',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ userId: currentUserId }),\n          });\n        }\n      } catch (e) {\n        console.error('Error auto-marking as read:', e);\n      }\n      messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n    } catch (e) {\n      console.error(e);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const markAsRead = async () => {\n    if (!conversationId) return;\n    try {\n      await fetch(`/api/mensagens/${conversationId}`, {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ userId: currentUserId }),\n      });\n    } catch (e) {\n      console.error('Erro ao marcar como lidas:', e);\n    }\n  };\n\n  useEffect(() => {\n    if (!conversationId || !currentUserId) return;\n\n    fetchData();\n    markAsRead();\n\n    console.log('üî• Configurando listener Supabase para conversationId:', conversationId);\n\n    const channel = supabase\n      .channel(`chat-${conversationId}`)\n      .on(\n        'postgres_changes',\n        {\n          event: '*', // INSERT, UPDATE, DELETE\n          schema: 'public',\n          table: 'chat_messages',\n          filter: `conversation_id=eq.${conversationId}`,\n        },\n        (payload) => {\n          console.log('üî• Supabase Realtime Message:', payload);\n          \n          if (payload.eventType === 'INSERT') {\n            const newMsg = payload.new as any;\n            const formattedMsg: Message = {\n              id: newMsg.id,\n              conversationId: newMsg.conversation_id,\n              senderId: newMsg.sender_id,\n              senderName: newMsg.sender_name,\n              receiverId: newMsg.receiver_id,\n              text: newMsg.text,\n              createdAt: newMsg.created_at,\n              read: newMsg.read,\n              attachments: newMsg.attachments || [],\n              deletedBy: newMsg.deleted_for || [], // Mapeando deleted_for do banco para deletedBy\n              deletedForEveryone: newMsg.deleted_for_all,\n              deletedForEveryoneAt: newMsg.deleted_for_all_at\n            };\n            \n            setMessages((prev) => {\n              // Evitar duplicatas\n              if (prev.find(m => m.id === formattedMsg.id)) return prev;\n              return [...prev, formattedMsg];\n            });\n\n            setTimeout(() => {\n              messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n            }, 100);\n\n            if (formattedMsg.receiverId === currentUserId) {\n              markAsRead();\n            }\n          } else {\n            // Para UPDATE ou DELETE, recarregar tudo √© mais seguro para garantir consist√™ncia\n            // (Ex: mensagem deletada para todos, editada, ou lida)\n            fetchData();\n          }\n        }\n      )\n      .subscribe();\n\n    return () => {\n      console.log('üî• Removendo listener Supabase');\n      supabase.removeChannel(channel);\n    };\n  }, [conversationId, currentUserId]);\n\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      const target = event.target as HTMLElement;\n\n      if (showEmojiPicker && !target.closest('.emoji-picker-container')) {\n        setShowEmojiPicker(false);\n      }\n\n      if (contextMenu && !target.closest('.context-menu-container')) {\n        console.log('üñ±Ô∏è Fechando menu de contexto (clique fora)');\n        setContextMenu(null);\n      }\n\n      if (showMoreMenu && !target.closest('.more-menu-button') && !target.closest('.more-menu-dropdown')) {\n        setShowMoreMenu(false);\n      }\n    };\n\n    if (showEmojiPicker || contextMenu || showMoreMenu) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [showEmojiPicker, contextMenu, showMoreMenu]);\n\n  const handleSend = async () => {\n    if ((!messageText.trim() && !selectedFile) || !conversation) return;\n    if (!currentUserId) {\n      alert('Sess√£o inv√°lida. Fa√ßa login novamente para enviar mensagens.');\n      return;\n    }\n\n    const text = messageText.trim();\n    setMessageText('');\n    setSending(true);\n    setUploading(!!selectedFile);\n\n    try {\n      const otherUserId = conversation.participants.find(p => p !== currentUserId);\n      if (!otherUserId) throw new Error('Destinat√°rio n√£o encontrado');\n\n      let attachments: Attachment[] = [];\n\n      if (selectedFile) {\n        const formData = new FormData();\n        formData.append('file', selectedFile);\n        formData.append('conversationId', conversationId || '');\n\n        const uploadRes = await fetch('/api/upload', {\n          method: 'POST',\n          body: formData,\n        });\n\n        if (!uploadRes.ok) {\n          throw new Error('Falha ao fazer upload do arquivo');\n        }\n\n        const uploadData = await uploadRes.json();\n        attachments = [uploadData.attachment];\n      }\n\n      const res = await fetch('/api/mensagens', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          senderId: currentUserId,\n          senderName: currentUserName,\n          receiverId: otherUserId,\n          text: text || (selectedFile ? `Enviou um ${selectedFile.type.startsWith('image/') ? 'imagem' : 'arquivo'}` : ''),\n          attachments: attachments.length > 0 ? attachments : undefined,\n        }),\n      });\n\n      if (!res.ok) {\n        const err = await res.json().catch(() => ({}));\n        throw new Error(err?.error || 'Falha ao enviar');\n      }\n\n      clearSelectedFile();\n      await fetchData();\n    } catch (e) {\n      console.error('Erro ao enviar:', e);\n      setMessageText(text);\n      alert('Erro ao enviar mensagem');\n    } finally {\n      setSending(false);\n      setUploading(false);\n    }\n  };\n\n  const handleFileClick = () => {\n    fileInputRef.current?.click();\n  };\n\n  const handleImageClick = () => {\n    imageInputRef.current?.click();\n  };\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      if (file.size > 10 * 1024 * 1024) {\n        alert('Arquivo muito grande! Tamanho m√°ximo: 10MB');\n        e.target.value = '';\n        return;\n      }\n\n      setSelectedFile(file);\n      setFilePreview(null);\n      e.target.value = '';\n    }\n  };\n\n  const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      if (file.size > 10 * 1024 * 1024) {\n        alert('Imagem muito grande! Tamanho m√°ximo: 10MB');\n        e.target.value = '';\n        return;\n      }\n\n      setSelectedFile(file);\n\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setFilePreview(reader.result as string);\n      };\n      reader.readAsDataURL(file);\n\n      e.target.value = '';\n    }\n  };\n\n  const clearSelectedFile = () => {\n    setSelectedFile(null);\n    setFilePreview(null);\n  };\n\n  const handleEmojiClick = (emoji: string) => {\n    setMessageText(prev => prev + emoji);\n    setShowEmojiPicker(false);\n  };\n\n  const handleContextMenu = (e: React.MouseEvent, msg: Message, isMine: boolean) => {\n    console.log('üñ±Ô∏è Bot√£o direito clicado', { isMine, msgId: msg.id, deletedForEveryone: msg.deletedForEveryone });\n\n    if (!isMine) {\n      console.log('üñ±Ô∏è Menu bloqueado: n√£o √© mensagem pr√≥pria');\n      return;\n    }\n    if (msg.deletedForEveryone) {\n      console.log('üñ±Ô∏è Menu bloqueado: mensagem j√° deletada para todos');\n      return;\n    }\n\n    e.preventDefault();\n    const isSender = msg.senderId === currentUserId;\n    console.log('üñ±Ô∏è Abrindo menu de contexto', { isSender, messageId: msg.id });\n\n    setContextMenu({\n      x: e.clientX,\n      y: e.clientY,\n      messageId: msg.id,\n      createdAt: msg.createdAt,\n      isSender,\n    });\n  };\n\n  const isWithin30Minutes = (createdAt: string): boolean => {\n    const created = new Date(createdAt);\n    const now = new Date();\n    const diffMinutes = (now.getTime() - created.getTime()) / (1000 * 60);\n    return diffMinutes <= 30;\n  };\n\n  const handleDeleteForMeClick = () => {\n    console.log('üìù Clicou em \"Excluir para mim\"', contextMenu);\n    if (contextMenu) {\n      setMessageToDelete(contextMenu.messageId);\n      setDeleteForEveryone(false);\n      setShowDeleteModal(true);\n      setContextMenu(null);\n      console.log('üìù Modal de exclus√£o aberta (para mim)');\n    }\n  };\n\n  const handleDeleteForEveryoneClick = () => {\n    console.log('üìù Clicou em \"Excluir para todos\"', contextMenu);\n    if (contextMenu) {\n      setMessageToDelete(contextMenu.messageId);\n      setDeleteForEveryone(true);\n      setShowDeleteModal(true);\n      setContextMenu(null);\n      console.log('üìù Modal de exclus√£o aberta (para todos)');\n    }\n  };\n\n  const handleDeleteMessage = async () => {\n    if (!messageToDelete || !currentUserId) {\n      console.error('DEBUG: Faltam dados para deletar', { messageToDelete, currentUserId });\n      return;\n    }\n\n    const url = deleteForEveryone\n      ? `/api/mensagens/message/${messageToDelete}?forEveryone=true`\n      : `/api/mensagens/message/${messageToDelete}`;\n\n    console.log('DEBUG: Tentando deletar mensagem', {\n      messageId: messageToDelete,\n      userId: currentUserId,\n      forEveryone: deleteForEveryone,\n      url\n    });\n\n    try {\n      const res = await fetch(url, {\n        method: 'DELETE',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ userId: currentUserId }),\n      });\n\n      console.log('DEBUG: Resposta da API', {\n        status: res.status,\n        ok: res.ok\n      });\n\n      const responseData = await res.json();\n      console.log('DEBUG: Dados da resposta', responseData);\n\n      if (!res.ok) {\n        throw new Error(responseData.error || 'Falha ao deletar');\n      }\n\n      setShowDeleteModal(false);\n      setMessageToDelete(null);\n      setDeleteForEveryone(false);\n      console.log('DEBUG: Recarregando mensagens...');\n      await fetchData();\n      console.log('DEBUG: Mensagens recarregadas');\n    } catch (error) {\n      console.error('Erro ao deletar mensagem:', error);\n      alert(`Erro ao deletar mensagem: ${error}`);\n    }\n  };\n\n  useEffect(() => {\n    let interval: ReturnType<typeof setInterval> | undefined;\n    if (isInCall) {\n      interval = setInterval(() => {\n        setCallDuration(prev => prev + 1);\n      }, 1000);\n    } else {\n      setCallDuration(0);\n    }\n    return () => {\n      if (interval) clearInterval(interval);\n    };\n  }, [isInCall]);\n\n  useEffect(() => {\n    if (localVideoRef.current && callState.localStream) {\n      localVideoRef.current.srcObject = callState.localStream;\n    }\n  }, [callState.localStream]);\n\n  useEffect(() => {\n    if (remoteVideoRef.current && callState.remoteStream) {\n      remoteVideoRef.current.srcObject = callState.remoteStream;\n    }\n  }, [callState.remoteStream]);\n\n  useEffect(() => {\n    if (callState.callStatus === 'ringing') {\n      if (callState.callType === 'video') {\n        setShowVideoCallModal(true);\n      } else {\n        setShowVoiceCallModal(true);\n      }\n    } else if (callState.callStatus === 'connected' && !isInCall) {\n      setIsInCall(true);\n    } else if (callState.callStatus === 'idle' && (isInCall || showVoiceCallModal || showVideoCallModal)) {\n      setIsInCall(false);\n      setShowVoiceCallModal(false);\n      setShowVideoCallModal(false);\n    }\n  }, [callState.callStatus, callState.callType, isInCall, showVoiceCallModal, showVideoCallModal]);\n\n  const handleVoiceCall = async () => {\n    const success = await startCall('voice');\n    if (success) {\n      setShowVoiceCallModal(true);\n      setIsInCall(true);\n    }\n  };\n\n  const handleVideoCall = async () => {\n    const success = await startCall('video');\n    if (success) {\n      setShowVideoCallModal(true);\n      setIsInCall(true);\n    }\n  };\n\n  const handleEndCall = () => {\n    endWebRTCCall();\n    setIsInCall(false);\n    setShowVoiceCallModal(false);\n    setShowVideoCallModal(false);\n    setCallDuration(0);\n  };\n\n  const formatCallDuration = (seconds: number): string => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  const handleClearConversation = async () => {\n    if (!confirm('Tem certeza que deseja limpar todas as mensagens desta conversa? Esta a√ß√£o n√£o pode ser desfeita.')) {\n      return;\n    }\n\n    try {\n      const deletePromises = messages.map(msg =>\n        fetch(`/api/mensagens/message/${msg.id}`, {\n          method: 'DELETE',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ userId: currentUserId }),\n        })\n      );\n\n      await Promise.all(deletePromises);\n      await fetchData();\n      setShowMoreMenu(false);\n      alert('Conversa limpa com sucesso!');\n    } catch (error) {\n      console.error('Erro ao limpar conversa:', error);\n      alert('Erro ao limpar conversa');\n    }\n  };\n\n  const handleMuteConversation = () => {\n    alert('Conversa silenciada! (funcionalidade em desenvolvimento)');\n    setShowMoreMenu(false);\n  };\n\n  const handleBlockUser = () => {\n    if (!confirm(`Tem certeza que deseja bloquear ${otherUserName}?`)) {\n      return;\n    }\n    alert('Usu√°rio bloqueado! (funcionalidade em desenvolvimento)');\n    setShowMoreMenu(false);\n  };\n\n  const emojis = ['üòÄ', 'üòÇ', 'üòç', 'ü•∞', 'üòä', 'üòé', 'ü§î', 'üò¢', 'üò≠', 'üò°', 'üëç', 'üëé', '‚ù§Ô∏è', 'üéâ', 'üî•', '‚ú®', 'üí™', 'üôè', 'üëè', 'üéä'];\n\n  const formatTime = (d: string) => new Date(d).toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });\n\n  const otherUserName = !conversation\n    ? 'Carregando...'\n    : conversation.participantNames?.[otherUserId] || 'Usu√°rio';\n\n  const isOtherUserOnline = !!(otherUserId && conversation?.onlineStatus?.[otherUserId]);\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-[#F8F9FA] to-[#E9ECEF] flex flex-col\">\n      {/* Header Melhorado */}\n      <div className=\"sticky top-0 z-10 bg-gradient-to-r from-[#1F53A2] to-[#2E67C3] shadow-xl\">\n        <div className=\"max-w-5xl mx-auto px-4 sm:px-6 py-4\">\n          <div className=\"flex items-center gap-4\">\n            <button\n              onClick={() => router.back()}\n              className=\"p-2.5 rounded-xl hover:bg-white/20 transition-all duration-300 backdrop-blur-sm\"\n              title=\"Voltar\"\n            >\n              <ArrowLeft className=\"w-6 h-6 text-white\" />\n            </button>\n\n            <div className=\"relative flex-shrink-0\">\n              <div className=\"w-12 h-12 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center text-white font-bold text-lg shadow-lg ring-4 ring-white/20\">\n                {otherUserName.substring(0, 2).toUpperCase()}\n              </div>\n              <div className=\"absolute bottom-0 right-0\">\n                <Circle className={`w-4 h-4 ${\n                  isOtherUserOnline ? 'text-green-400 fill-green-400' : 'text-gray-400 fill-gray-400'\n                } bg-[#1F53A2] rounded-full ring-2 ring-[#1F53A2]`} />\n              </div>\n            </div>\n\n            <div className=\"flex-1 min-w-0\">\n              <h2 className=\"font-bold text-white text-lg truncate\">{otherUserName}</h2>\n              <p className=\"text-sm flex items-center gap-1.5 text-white/80\">\n                {isOtherUserOnline ? (\n                  <>\n                    <Circle className=\"w-2.5 h-2.5 text-green-400 fill-green-400\" />\n                    <span className=\"font-medium\">Online</span>\n                  </>\n                ) : (\n                  <>\n                    <MessageSquare className=\"w-3.5 h-3.5\" />\n                    <span>{messages.length} mensagens</span>\n                  </>\n                )}\n              </p>\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              <button\n                onClick={handleVoiceCall}\n                className=\"p-2.5 rounded-xl hover:bg-white/20 transition-all duration-300 text-white backdrop-blur-sm\"\n                title=\"Chamada de voz\"\n              >\n                <Phone className=\"w-5 h-5\" />\n              </button>\n              <button\n                onClick={handleVideoCall}\n                className=\"p-2.5 rounded-xl hover:bg-white/20 transition-all duration-300 text-white backdrop-blur-sm\"\n                title=\"Chamada de v√≠deo\"\n              >\n                <Video className=\"w-5 h-5\" />\n              </button>\n              <button\n                onClick={() => setShowInfoModal(true)}\n                className=\"p-2.5 rounded-xl hover:bg-white/20 transition-all duration-300 text-white backdrop-blur-sm\"\n                title=\"Informa√ß√µes\"\n              >\n                <Info className=\"w-5 h-5\" />\n              </button>\n              <div className=\"relative\">\n                <button\n                  onClick={() => setShowMoreMenu(!showMoreMenu)}\n                  className=\"more-menu-button p-2.5 rounded-xl hover:bg-white/20 transition-all duration-300 text-white backdrop-blur-sm\"\n                  title=\"Mais op√ß√µes\"\n                >\n                  <MoreVertical className=\"w-5 h-5\" />\n                </button>\n\n                {showMoreMenu && (\n                  <div className=\"more-menu-dropdown absolute right-0 top-full mt-2 bg-white border border-[#E0E0E0] rounded-xl shadow-2xl py-2 z-50 min-w-[220px]\">\n                    <button\n                      onClick={handleMuteConversation}\n                      className=\"w-full px-4 py-2.5 text-left text-sm text-[#212121] hover:bg-[#F5F5F5] flex items-center gap-3 transition-all font-medium\"\n                    >\n                      <svg className=\"w-5 h-5 text-[#757575]\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z\" clipRule=\"evenodd\" />\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2\" />\n                      </svg>\n                      Silenciar conversa\n                    </button>\n                    <button\n                      onClick={handleClearConversation}\n                      className=\"w-full px-4 py-2.5 text-left text-sm text-[#212121] hover:bg-[#F5F5F5] flex items-center gap-3 transition-all font-medium\"\n                    >\n                      <svg className=\"w-5 h-5 text-[#757575]\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\n                      </svg>\n                      Limpar conversa\n                    </button>\n                    <div className=\"border-t border-[#E0E0E0] my-1.5\"></div>\n                    <button\n                      onClick={handleBlockUser}\n                      className=\"w-full px-4 py-2.5 text-left text-sm text-[#E82129] hover:bg-red-50 flex items-center gap-3 transition-all font-medium\"\n                    >\n                      <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636\" />\n                      </svg>\n                      Bloquear usu√°rio\n                    </button>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* √Årea de Mensagens */}\n      <div className=\"flex-1 overflow-y-auto scroll-smooth\">\n        <div className=\"max-w-5xl mx-auto px-4 sm:px-6 py-6 space-y-4\">\n          {loading && (\n            <div className=\"text-center py-20\">\n              <div className=\"inline-flex items-center justify-center w-16 h-16 rounded-full bg-gradient-to-br from-[#1F53A2] to-[#2E67C3] mb-6 animate-pulse\">\n                <RefreshCw className=\"w-8 h-8 text-white animate-spin\" />\n              </div>\n              <p className=\"text-xl font-bold text-[#212121]\">Carregando mensagens...</p>\n              <p className=\"text-sm text-[#757575] mt-2\">Buscando hist√≥rico da conversa</p>\n            </div>\n          )}\n\n          {!loading && messages.length === 0 && (\n            <div className=\"text-center py-20\">\n              <div className=\"inline-flex items-center justify-center w-20 h-20 rounded-full bg-gradient-to-br from-[#E0E0E0] to-[#BDBDBD] mb-6\">\n                <MessageSquare className=\"w-10 h-10 text-[#757575]\" />\n              </div>\n              <p className=\"text-xl font-bold text-[#212121] mb-2\">Nenhuma mensagem ainda</p>\n              <p className=\"text-sm text-[#757575] flex items-center gap-2 justify-center\">\n                <Smile className=\"w-4 h-4\" />\n                Envie a primeira mensagem para {otherUserName}\n              </p>\n            </div>\n          )}\n\n          {messages.map((msg) => {\n            const isMine = msg.senderId === currentUserId;\n\n            if (msg.deletedForEveryone) {\n              return (\n                <div key={msg.id} className={`flex items-end gap-3 ${isMine ? 'justify-end' : 'justify-start'}`}>\n                  {!isMine && (\n                    <div className=\"w-9 h-9 rounded-full bg-gradient-to-br from-[#757575] to-[#616161] flex items-center justify-center text-white text-xs font-bold shadow-md opacity-50\">\n                      {msg.senderName.substring(0, 2).toUpperCase()}\n                    </div>\n                  )}\n                  <div className=\"max-w-[70%] rounded-2xl px-4 py-3 shadow-md border-2 border-[#E0E0E0] bg-gradient-to-br from-[#F5F5F5] to-[#E9ECEF] opacity-70\">\n                    <p className=\"text-sm italic text-[#757575] flex items-center gap-2 font-medium\">\n                      <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\n                      </svg>\n                      Mensagem exclu√≠da\n                    </p>\n                    <div className=\"text-xs mt-2 text-[#9E9E9E] flex items-center gap-1 justify-end font-medium\">\n                      <Clock className=\"w-3 h-3\" />\n                      {formatTime(msg.createdAt)}\n                    </div>\n                  </div>\n                  {isMine && (\n                    <div className=\"w-9 h-9 rounded-full bg-gradient-to-br from-[#1F53A2] to-[#2E67C3] flex items-center justify-center text-white text-xs font-bold shadow-md opacity-50 ring-2 ring-[#1F53A2]/20\">\n                      {currentUserName.substring(0, 2).toUpperCase()}\n                    </div>\n                  )}\n                </div>\n              );\n            }\n\n            return (\n              <div key={msg.id} className={`flex items-end gap-3 ${isMine ? 'justify-end' : 'justify-start'} group`}>\n                {!isMine && (\n                  <div className=\"w-9 h-9 rounded-full bg-gradient-to-br from-[#757575] to-[#616161] flex items-center justify-center text-white text-xs font-bold shadow-md\">\n                    {msg.senderName.substring(0, 2).toUpperCase()}\n                  </div>\n                )}\n                <div\n                  className={`max-w-[70%] rounded-2xl px-4 py-3 shadow-lg border-2 transition-all duration-300 ${\n                    isMine\n                      ? 'bg-gradient-to-br from-[#E3EFFF] to-[#F0F7FF] border-[#1F53A2]/20 cursor-context-menu hover:shadow-xl'\n                      : 'bg-white border-[#E0E0E0] hover:shadow-xl'\n                  }`}\n                  onContextMenu={(e) => handleContextMenu(e, msg, isMine)}\n                >\n                  {msg.attachments && msg.attachments.length > 0 && (\n                    <div className=\"mb-3 space-y-2\">\n                      {msg.attachments.filter(att => att && att.type).map((attachment, idx) => (\n                        <div key={idx}>\n                          {attachment.type === 'image' ? (\n                            <a href={attachment.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                              <img\n                                src={attachment.url}\n                                alt={attachment.name}\n                                className=\"max-w-full rounded-xl cursor-pointer hover:opacity-90 transition-opacity shadow-md border border-[#E0E0E0]\"\n                                style={{ maxHeight: '300px' }}\n                              />\n                            </a>\n                          ) : (\n                            <a\n                              href={attachment.url}\n                              download={attachment.name}\n                              target=\"_blank\"\n                              rel=\"noopener noreferrer\"\n                              className=\"flex items-center gap-3 p-3 bg-[#F5F5F5] rounded-xl hover:bg-[#E9ECEF] transition-colors border border-[#E0E0E0]\"\n                            >\n                              <div className=\"p-2 bg-gradient-to-br from-[#1F53A2] to-[#2E67C3] rounded-lg\">\n                                <Paperclip className=\"w-4 h-4 text-white\" />\n                              </div>\n                              <div className=\"flex-1 min-w-0\">\n                                <p className=\"text-xs font-bold text-[#212121] truncate\">{attachment.name}</p>\n                                <p className=\"text-xs text-[#757575] font-medium\">{(attachment.size / 1024).toFixed(2)} KB</p>\n                              </div>\n                            </a>\n                          )}\n                        </div>\n                      ))}\n                    </div>\n                  )}\n                  {msg.text && (\n                    <div \n                      className=\"text-sm break-words text-[#212121] leading-relaxed [&>p]:mb-1 [&>ul]:list-disc [&>ul]:pl-4 [&>ol]:list-decimal [&>ol]:pl-4\"\n                      dangerouslySetInnerHTML={{ __html: DOMPurify.sanitize(msg.text) }}\n                    />\n                  )}\n                  <div className=\"text-xs mt-2 text-[#757575] flex items-center gap-2 justify-end font-medium\">\n                    <span className=\"inline-flex items-center gap-1\">\n                      <Clock className=\"w-3 h-3\" />\n                      {formatTime(msg.createdAt)}\n                    </span>\n                    {isMine && (\n                      <span className=\"inline-flex items-center gap-1\" title={msg.read ? 'Lida' : 'Enviada'}>\n                        {msg.read ? (\n                          <CheckCheck className=\"w-4 h-4 text-[#1F53A2]\" />\n                        ) : (\n                          <Check className=\"w-4 h-4 text-[#757575]\" />\n                        )}\n                      </span>\n                    )}\n                  </div>\n                </div>\n                {isMine && (\n                  <div className=\"w-9 h-9 rounded-full bg-gradient-to-br from-[#1F53A2] to-[#2E67C3] flex items-center justify-center text-white text-xs font-bold shadow-md ring-4 ring-[#1F53A2]/20\">\n                    {currentUserName.substring(0, 2).toUpperCase()}\n                  </div>\n                )}\n              </div>\n            );\n          })}\n          <div ref={messagesEndRef} />\n        </div>\n      </div>\n\n      {/* √Årea de Input Melhorada */}\n      <div className=\"sticky bottom-0 z-10 bg-white shadow-2xl border-t-2 border-[#E0E0E0]\">\n        <div className=\"max-w-5xl mx-auto px-4 sm:px-6 py-4\">\n          <input\n            ref={fileInputRef}\n            type=\"file\"\n            className=\"hidden\"\n            onChange={handleFileChange}\n            accept=\"*/*\"\n          />\n          <input\n            ref={imageInputRef}\n            type=\"file\"\n            className=\"hidden\"\n            onChange={handleImageChange}\n            accept=\"image/*\"\n          />\n\n          <div className=\"flex gap-2 mb-3\">\n            <button\n              type=\"button\"\n              onClick={handleFileClick}\n              className=\"p-2.5 rounded-xl hover:bg-[#F5F5F5] text-[#757575] hover:text-[#1F53A2] transition-all disabled:opacity-50 border border-[#E0E0E0]\"\n              title=\"Anexar arquivo\"\n              disabled={sending}\n            >\n              <Paperclip className=\"w-5 h-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleImageClick}\n              className=\"p-2.5 rounded-xl hover:bg-[#F5F5F5] text-[#757575] hover:text-[#1F53A2] transition-all disabled:opacity-50 border border-[#E0E0E0]\"\n              title=\"Anexar imagem\"\n              disabled={sending}\n            >\n              <Image className=\"w-5 h-5\" />\n            </button>\n            <div className=\"relative emoji-picker-container\">\n              <button\n                type=\"button\"\n                onClick={() => setShowEmojiPicker(!showEmojiPicker)}\n                className={`p-2.5 rounded-xl hover:bg-[#F5F5F5] text-[#757575] hover:text-[#1F53A2] transition-all disabled:opacity-50 border border-[#E0E0E0] ${showEmojiPicker ? 'bg-[#E3EFFF] text-[#1F53A2]' : ''}`}\n                title=\"Emoji\"\n                disabled={sending}\n              >\n                <Smile className=\"w-5 h-5\" />\n              </button>\n\n              {showEmojiPicker && (\n                <div className=\"absolute bottom-full left-0 mb-2 bg-white border-2 border-[#E0E0E0] rounded-2xl shadow-2xl p-4 z-50\">\n                  <div className=\"flex items-center justify-between mb-3\">\n                    <span className=\"text-sm text-[#757575] font-bold\">Emojis</span>\n                    <button\n                      onClick={() => setShowEmojiPicker(false)}\n                      className=\"text-[#757575] hover:text-[#E82129] transition-colors\"\n                    >\n                      <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                      </svg>\n                    </button>\n                  </div>\n                  <div className=\"grid grid-cols-5 gap-2 w-64\">\n                    {emojis.map((emoji, idx) => (\n                      <button\n                        key={idx}\n                        onClick={() => handleEmojiClick(emoji)}\n                        className=\"text-2xl p-2 hover:bg-[#E3EFFF] rounded-xl transition-all duration-300 hover:scale-125\"\n                        title={emoji}\n                      >\n                        {emoji}\n                      </button>\n                    ))}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {selectedFile && (\n            <div className=\"mb-3 p-4 bg-gradient-to-br from-[#E3EFFF] to-[#F0F7FF] rounded-2xl border-2 border-[#1F53A2]/30 shadow-md\">\n              <div className=\"flex items-start gap-3\">\n                {filePreview ? (\n                  <img\n                    src={filePreview}\n                    alt=\"Preview\"\n                    className=\"w-20 h-20 object-cover rounded-xl border-2 border-[#1F53A2]/20 shadow-md\"\n                  />\n                ) : (\n                  <div className=\"w-20 h-20 bg-gradient-to-br from-[#1F53A2] to-[#2E67C3] rounded-xl flex items-center justify-center shadow-md\">\n                    <Paperclip className=\"w-8 h-8 text-white\" />\n                  </div>\n                )}\n                <div className=\"flex-1 min-w-0\">\n                  <p className=\"font-bold text-[#212121] truncate\">{selectedFile.name}</p>\n                  <p className=\"text-sm text-[#757575] font-medium\">\n                    {(selectedFile.size / 1024).toFixed(2)} KB\n                  </p>\n                  {uploading && (\n                    <p className=\"text-xs text-[#1F53A2] mt-1 flex items-center gap-1 font-medium\">\n                      <RefreshCw className=\"w-3 h-3 animate-spin\" />\n                      Fazendo upload...\n                    </p>\n                  )}\n                </div>\n                <button\n                  onClick={clearSelectedFile}\n                  disabled={uploading || sending}\n                  className=\"p-2 hover:bg-white/50 rounded-xl transition-all disabled:opacity-50\"\n                  title=\"Remover arquivo\"\n                >\n                  <svg className=\"w-5 h-5 text-[#E82129]\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                  </svg>\n                </button>\n              </div>\n            </div>\n          )}\n\n          <div className=\"flex gap-3\">\n            <input\n              type=\"text\"\n              value={messageText}\n              onChange={(e) => setMessageText(e.target.value)}\n              onKeyDown={(e) => {\n                if (e.key === 'Enter' && !e.shiftKey) {\n                  e.preventDefault();\n                  handleSend();\n                }\n              }}\n              placeholder=\"Digite uma mensagem...\"\n              disabled={sending}\n              className=\"flex-1 px-4 py-3 border-2 border-[#E0E0E0] rounded-2xl focus:outline-none focus:ring-2 focus:ring-[#1F53A2]/30 focus:border-[#1F53A2] text-[#212121] placeholder-[#757575] font-medium transition-all shadow-sm\"\n              maxLength={500}\n            />\n            <button\n              onClick={handleSend}\n              disabled={(!messageText.trim() && !selectedFile) || sending}\n              className=\"px-6 py-3 bg-gradient-to-r from-[#1F53A2] to-[#2E67C3] hover:from-[#1A4585] hover:to-[#2558AA] text-white rounded-2xl disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg hover:shadow-xl hover:scale-105 font-bold\"\n              title=\"Enviar mensagem\"\n            >\n              {sending ? <RefreshCw className=\"w-5 h-5 animate-spin\" /> : <Send className=\"w-5 h-5\" />}\n            </button>\n          </div>\n          <div className=\"mt-2 text-xs text-[#757575] flex items-center gap-1 font-medium\">\n            <Info className=\"w-3 h-3\" />\n            {messageText.length}/500 caracteres\n          </div>\n        </div>\n      </div>\n\n      {/* Menu de contexto */}\n      {contextMenu && (\n        <div\n          className=\"context-menu-container fixed bg-white border-2 border-[#E0E0E0] rounded-xl shadow-2xl py-2 z-50 min-w-[200px]\"\n          style={{\n            left: `${contextMenu.x}px`,\n            top: `${contextMenu.y}px`,\n          }}\n          onClick={(e) => e.stopPropagation()}\n        >\n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              handleDeleteForMeClick();\n            }}\n            className=\"w-full px-4 py-2.5 text-left text-sm text-[#212121] hover:bg-[#F5F5F5] flex items-center gap-3 transition-all font-medium\"\n          >\n            <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\n            </svg>\n            Excluir para mim\n          </button>\n\n          {contextMenu.isSender && isWithin30Minutes(contextMenu.createdAt) && (\n            <>\n              <div className=\"border-t border-[#E0E0E0] my-1\"></div>\n              <button\n                onClick={(e) => {\n                  e.stopPropagation();\n                  handleDeleteForEveryoneClick();\n                }}\n                className=\"w-full px-4 py-2.5 text-left text-sm text-[#E82129] hover:bg-red-50 flex items-center gap-3 transition-all font-medium\"\n              >\n                <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\n                </svg>\n                <div className=\"flex-1\">\n                  <div>Excluir para todos</div>\n                  <div className=\"text-xs text-[#757575]\">Remove para ambos</div>\n                </div>\n              </button>\n            </>\n          )}\n        </div>\n      )}\n\n      {/* Modal de confirma√ß√£o de exclus√£o */}\n      {showDeleteModal && (\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 border border-[#E0E0E0]\">\n            <div className=\"flex items-center gap-4 mb-6\">\n              <div className={`w-14 h-14 rounded-full flex items-center justify-center ${\n                deleteForEveryone ? 'bg-gradient-to-br from-[#E82129] to-[#C62828]' : 'bg-gradient-to-br from-[#FF9800] to-[#F57C00]'\n              } shadow-lg`}>\n                <svg className=\"w-7 h-7 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\n                </svg>\n              </div>\n              <div>\n                <h3 className=\"text-xl font-bold text-[#212121]\">\n                  {deleteForEveryone ? 'Excluir para todos' : 'Excluir mensagem'}\n                </h3>\n                <p className=\"text-sm text-[#757575] font-medium\">Esta a√ß√£o n√£o pode ser desfeita</p>\n              </div>\n            </div>\n\n            <div className={`rounded-xl p-4 mb-6 border-2 ${\n              deleteForEveryone ? 'bg-red-50 border-red-200' : 'bg-orange-50 border-orange-200'\n            }`}>\n              <p className=\"text-sm text-[#212121] leading-relaxed font-medium\">\n                {deleteForEveryone ? (\n                  <>\n                    <strong className=\"text-[#E82129]\">A mensagem ser√° exclu√≠da para todos os participantes.</strong>\n                    <br />\n                    Ningu√©m mais poder√° v√™-la nesta conversa.\n                  </>\n                ) : (\n                  'A mensagem ser√° exclu√≠da apenas para voc√™. O destinat√°rio ainda poder√° v√™-la.'\n                )}\n              </p>\n            </div>\n\n            <div className=\"flex gap-3\">\n              <button\n                onClick={() => {\n                  setShowDeleteModal(false);\n                  setMessageToDelete(null);\n                  setDeleteForEveryone(false);\n                }}\n                className=\"flex-1 px-4 py-3 border-2 border-[#E0E0E0] rounded-xl text-[#212121] hover:bg-[#F5F5F5] transition-all font-bold\"\n              >\n                Cancelar\n              </button>\n              <button\n                onClick={handleDeleteMessage}\n                className={`flex-1 px-4 py-3 text-white rounded-xl transition-all font-bold shadow-lg hover:shadow-xl ${\n                  deleteForEveryone\n                    ? 'bg-gradient-to-r from-[#E82129] to-[#C62828] hover:from-[#D32F2F] hover:to-[#B71C1C]'\n                    : 'bg-gradient-to-r from-[#FF9800] to-[#F57C00] hover:from-[#F57C00] hover:to-[#E65100]'\n                }`}\n              >\n                Excluir\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Modal de Informa√ß√µes - vers√£o simplificada por limite de caracteres */}\n      {showInfoModal && (\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6\">\n            <div className=\"flex items-center justify-between mb-6\">\n              <h3 className=\"text-xl font-bold text-[#212121]\">Informa√ß√µes do Contato</h3>\n              <button\n                onClick={() => setShowInfoModal(false)}\n                className=\"p-2 hover:bg-[#F5F5F5] rounded-xl transition-all\"\n              >\n                <svg className=\"w-5 h-5 text-[#757575]\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                </svg>\n              </button>\n            </div>\n\n            <div className=\"flex flex-col items-center mb-6\">\n              <div className=\"w-24 h-24 rounded-full bg-gradient-to-br from-[#1F53A2] to-[#2E67C3] flex items-center justify-center text-white text-3xl font-bold shadow-xl mb-4 ring-4 ring-[#1F53A2]/20\">\n                {otherUserName.substring(0, 2).toUpperCase()}\n              </div>\n              <h4 className=\"text-2xl font-bold text-[#212121] mb-2\">{otherUserName}</h4>\n              <div className=\"flex items-center gap-2\">\n                <Circle className={`w-3 h-3 ${isOtherUserOnline ? 'text-green-500 fill-green-500' : 'text-gray-400 fill-gray-400'}`} />\n                <span className={`text-sm font-medium ${isOtherUserOnline ? 'text-green-600' : 'text-gray-500'}`}>\n                  {isOtherUserOnline ? 'Online' : 'Offline'}\n                </span>\n              </div>\n            </div>\n\n            <div className=\"space-y-4\">\n              <div className=\"bg-gradient-to-br from-[#E3EFFF] to-[#F0F7FF] rounded-xl p-4 border border-[#1F53A2]/20\">\n                <div className=\"flex items-center gap-3 mb-3\">\n                  <MessageSquare className=\"w-5 h-5 text-[#1F53A2]\" />\n                  <span className=\"font-bold text-[#212121]\">Estat√≠sticas</span>\n                </div>\n                <div className=\"space-y-2 text-sm\">\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-[#757575] font-medium\">Total de mensagens:</span>\n                    <span className=\"font-bold text-[#1F53A2]\">{messages.length}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-[#757575] font-medium\">Desde:</span>\n                    <span className=\"font-bold text-[#212121]\">\n                      {conversation?.createdAt ? new Date(conversation.createdAt).toLocaleDateString('pt-BR') : '-'}\n                    </span>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"flex gap-3\">\n                <button\n                  onClick={() => {\n                    setShowInfoModal(false);\n                    handleVoiceCall();\n                  }}\n                  className=\"flex-1 px-4 py-3 bg-gradient-to-r from-[#1F53A2] to-[#2E67C3] hover:from-[#1A4585] hover:to-[#2558AA] text-white rounded-xl transition-all font-bold flex items-center justify-center gap-2 shadow-lg hover:scale-105\"\n                >\n                  <Phone className=\"w-4 h-4\" />\n                  Ligar\n                </button>\n                <button\n                  onClick={() => {\n                    setShowInfoModal(false);\n                    handleVideoCall();\n                  }}\n                  className=\"flex-1 px-4 py-3 bg-gradient-to-r from-[#5C94CC] to-[#1F53A2] hover:from-[#4A7FB8] hover:to-[#1A4585] text-white rounded-xl transition-all font-bold flex items-center justify-center gap-2 shadow-lg hover:scale-105\"\n                >\n                  <Video className=\"w-4 h-4\" />\n                  V√≠deo\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Modais de chamada mantidos simplificados */}\n      {showVoiceCallModal && (\n        <div className=\"fixed inset-0 bg-gradient-to-br from-[#1F53A2] to-[#153D7A] flex items-center justify-center z-50 p-4\">\n          <div className=\"max-w-md w-full text-center\">\n            <div className=\"mb-8\">\n              <div className=\"w-32 h-32 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center text-white text-4xl font-bold shadow-2xl mx-auto mb-6 animate-pulse ring-4 ring-white/20\">\n                {otherUserName.substring(0, 2).toUpperCase()}\n              </div>\n              <h3 className=\"text-3xl font-bold text-white mb-2\">{otherUserName}</h3>\n              <p className=\"text-white/80 text-lg mb-4\">\n                {isInCall ? 'Chamada em andamento' : 'Chamando...'}\n              </p>\n              {isInCall && (\n                <p className=\"text-white/90 text-2xl font-mono\">{formatCallDuration(callDuration)}</p>\n              )}\n            </div>\n\n            <div className=\"flex items-center justify-center gap-6\">\n              {callState.callStatus === 'ringing' ? (\n                <>\n                  <button\n                    onClick={handleEndCall}\n                    className=\"w-16 h-16 rounded-full bg-red-500 hover:bg-red-600 text-white transition-all shadow-2xl hover:scale-110 flex items-center justify-center\"\n                    title=\"Recusar\"\n                  >\n                    <Phone className=\"w-8 h-8 rotate-[135deg]\" />\n                  </button>\n                  <button\n                    onClick={() => acceptCall()}\n                    className=\"w-16 h-16 rounded-full bg-green-500 hover:bg-green-600 text-white transition-all shadow-2xl hover:scale-110 flex items-center justify-center animate-pulse\"\n                    title=\"Atender\"\n                  >\n                    <Phone className=\"w-8 h-8\" />\n                  </button>\n                </>\n              ) : (\n                <>\n                  <button\n                    onClick={handleEndCall}\n                    className=\"w-16 h-16 rounded-full bg-gradient-to-br from-[#E82129] to-[#C62828] hover:from-[#D32F2F] hover:to-[#B71C1C] text-white transition-all shadow-2xl hover:scale-110 flex items-center justify-center\"\n                    title=\"Encerrar chamada\"\n                  >\n                    <Phone className=\"w-6 h-6 rotate-[135deg]\" />\n                  </button>\n                  <button\n                    onClick={toggleMute}\n                    className=\"w-14 h-14 rounded-full bg-white/20 hover:bg-white/30 text-white transition-all backdrop-blur-sm flex items-center justify-center\"\n                    title=\"Silenciar microfone\"\n                  >\n                    {callState.isMuted ? (\n                      <svg className=\"w-5 h-5 text-red-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z\" />\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 3l18 18\" />\n                      </svg>\n                    ) : (\n                      <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z\" />\n                      </svg>\n                    )}\n                  </button>\n                </>\n              )}\n            </div>\n\n            {callState.callStatus === 'connected' && (\n              <div className=\"mt-6 bg-white/10 backdrop-blur-sm px-6 py-3 rounded-full inline-flex items-center gap-2\">\n                <div className=\"w-2 h-2 bg-green-400 rounded-full animate-pulse\"></div>\n                <span className=\"text-white text-sm font-medium\">Conectado</span>\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n\n      {showVideoCallModal && (\n        <div className=\"fixed inset-0 bg-black flex items-center justify-center z-50\">\n          <div className=\"w-full h-full relative\">\n            {callState.remoteStream ? (\n              <video\n                ref={remoteVideoRef}\n                autoPlay\n                playsInline\n                className=\"w-full h-full object-cover\"\n              />\n            ) : (\n              <div className=\"w-full h-full bg-gradient-to-br from-gray-800 to-gray-900 flex items-center justify-center\">\n                <div className=\"text-center\">\n                  <div className=\"w-40 h-40 rounded-full bg-gray-700 flex items-center justify-center text-white text-5xl font-bold shadow-2xl mx-auto mb-6 animate-pulse\">\n                    {otherUserName.substring(0, 2).toUpperCase()}\n                  </div>\n                  <h3 className=\"text-3xl font-bold text-white mb-2\">{otherUserName}</h3>\n                  <p className=\"text-gray-400 text-lg mb-4\">\n                    {callState.callStatus === 'calling' ? 'Chamando...' : 'Conectando...'}\n                  </p>\n                  {isInCall && (\n                    <p className=\"text-white text-2xl font-mono\">{formatCallDuration(callDuration)}</p>\n                  )}\n                </div>\n              </div>\n            )}\n\n            <div className=\"absolute top-4 right-4 w-48 h-36 bg-gray-800 rounded-xl shadow-2xl border-2 border-white/20 overflow-hidden\">\n              {callState.localStream ? (\n                <video\n                  ref={localVideoRef}\n                  autoPlay\n                  playsInline\n                  muted\n                  className=\"w-full h-full object-cover\"\n                  style={{ transform: 'scaleX(-1)' }}\n                />\n              ) : (\n                <div className=\"w-full h-full bg-gradient-to-br from-[#1F53A2] to-[#153D7A] flex items-center justify-center\">\n                  <div className=\"w-16 h-16 rounded-full bg-white/20 flex items-center justify-center text-white text-xl font-bold\">\n                    {currentUserName.substring(0, 2).toUpperCase()}\n                  </div>\n                </div>\n              )}\n            </div>\n\n            <div className=\"absolute bottom-8 left-1/2 transform -translate-x-1/2 flex items-center gap-4\">\n              {callState.callStatus === 'ringing' ? (\n                <>\n                  <button\n                    onClick={handleEndCall}\n                    className=\"w-16 h-16 rounded-full bg-red-500 hover:bg-red-600 text-white transition-all shadow-2xl hover:scale-110 flex items-center justify-center\"\n                    title=\"Recusar\"\n                  >\n                    <Phone className=\"w-8 h-8 rotate-[135deg]\" />\n                  </button>\n                  <button\n                    onClick={() => acceptCall()}\n                    className=\"w-16 h-16 rounded-full bg-green-500 hover:bg-green-600 text-white transition-all shadow-2xl hover:scale-110 flex items-center justify-center animate-pulse\"\n                    title=\"Atender\"\n                  >\n                    <Video className=\"w-8 h-8\" />\n                  </button>\n                </>\n              ) : (\n                <>\n                  <button\n                    onClick={toggleMute}\n                    className=\"w-14 h-14 rounded-full bg-white/10 hover:bg-white/20 text-white transition-all backdrop-blur-md flex items-center justify-center\"\n                    title=\"Silenciar microfone\"\n                  >\n                    {callState.isMuted ? (\n                      <svg className=\"w-5 h-5 text-red-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z\" />\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 3l18 18\" />\n                      </svg>\n                    ) : (\n                      <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z\" />\n                      </svg>\n                    )}\n                  </button>\n                  <button\n                    onClick={handleEndCall}\n                    className=\"w-16 h-16 rounded-full bg-gradient-to-br from-[#E82129] to-[#C62828] hover:from-[#D32F2F] hover:to-[#B71C1C] text-white transition-all shadow-2xl hover:scale-110 flex items-center justify-center\"\n                    title=\"Encerrar chamada\"\n                  >\n                    <Phone className=\"w-6 h-6 rotate-[135deg]\" />\n                  </button>\n                  <button\n                    onClick={toggleVideo}\n                    className=\"w-14 h-14 rounded-full bg-white/10 hover:bg-white/20 text-white transition-all backdrop-blur-md flex items-center justify-center\"\n                    title=\"Desligar c√¢mera\"\n                  >\n                    <Video className=\"w-5 h-5\" />\n                  </button>\n                </>\n              )}\n            </div>\n\n            {callState.callStatus === 'connected' && (\n              <div className=\"absolute top-4 left-4 bg-green-600/80 backdrop-blur-sm px-4 py-2 rounded-full flex items-center gap-2\">\n                <div className=\"w-2 h-2 bg-white rounded-full animate-pulse\"></div>\n                <span className=\"text-white text-sm font-medium\">{formatCallDuration(callDuration)}</span>\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Elemento de √°udio oculto para chamadas de voz */}\n      <audio ref={remoteAudioRef} autoPlay style={{ display: 'none' }} />\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2939, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}