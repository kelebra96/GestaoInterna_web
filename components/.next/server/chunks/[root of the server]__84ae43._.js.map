{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 47, "column": 0}, "map": {"version":3,"sources":["turbopack://[project]/lib/supabase-admin.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\n// URL e Service Key do Supabase (server-side only)\nconst supabaseUrl = process.env.SUPABASE_URL || process.env.NEXT_PUBLIC_SUPABASE_URL || 'http://kong:8000';\nconst supabaseServiceKey =\n  process.env.SUPABASE_SERVICE_ROLE_KEY ||\n  process.env.SUPABASE_SECRET_KEY ||\n  process.env.SUPABASE_SERVICE_KEY ||\n  '';\n\nif (!supabaseServiceKey) {\n  console.warn('??  SUPABASE_SERVICE_ROLE_KEY or SUPABASE_SECRET_KEY not set - admin client will not work');\n}\n\n// Cliente Supabase Admin (bypassa Row Level Security)\n// APENAS para uso server-side (API routes, server components)\nexport const supabaseAdmin = createClient(supabaseUrl, supabaseServiceKey, {\n  auth: {\n    autoRefreshToken: false,\n    persistSession: false,\n  },\n});\n\n/**\n * Tipos de dados do banco\n */\n\nexport interface User {\n  id: string;\n  email: string;\n  displayName: string;\n  role: 'developer' | 'admin' | 'manager' | 'agent' | 'buyer';\n  companyId: string | null;\n  storeId: string | null;\n  storeIds: string[];\n  active: boolean;\n  createdAt: string;\n  lastSeen: string | null;\n  isOnline?: boolean;\n}\n\nexport interface Company {\n  id: string;\n  name: string;\n  tradingName?: string;\n  cnpj?: string;\n  active: boolean;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface Store {\n  id: string;\n  name: string;\n  code: string;\n  companyId: string;\n  managerId?: string | null;\n  agentId?: string | null;\n  address?: string;\n  city?: string;\n  state?: string;\n  active: boolean;\n  createdAt: string;\n  updatedAt: string;\n}\n\ntype DbUser = {\n  id: string;\n  email: string;\n  display_name: string | null;\n  role: string;\n  company_id: string | null;\n  store_id: string | null;\n  store_ids: string[] | null;\n  active: boolean | null;\n  created_at: string;\n  last_seen: string | null;\n};\n\ntype DbCompany = {\n  id: string;\n  name: string;\n  cnpj: string | null;\n  trading_name: string | null;\n  active: boolean | null;\n  created_at: string;\n  updated_at: string;\n};\n\ntype DbStore = {\n  id: string;\n  name: string;\n  code: string;\n  company_id: string;\n  manager_id: string | null;\n  agent_id: string | null;\n  address: string | null;\n  city: string | null;\n  state: string | null;\n  active: boolean | null;\n  created_at: string;\n  updated_at: string;\n};\n\nfunction mapUserRow(row: DbUser): User {\n  const lastSeen = row.last_seen ?? null;\n  const isOnline = lastSeen ? (Date.now() - new Date(lastSeen).getTime() < 5 * 60 * 1000) : false;\n  return {\n    id: row.id,\n    email: row.email,\n    displayName: row.display_name || row.email || 'Sem nome',\n    role: row.role as User['role'],\n    companyId: row.company_id,\n    storeId: row.store_id,\n    storeIds: Array.isArray(row.store_ids) ? row.store_ids : (row.store_id ? [row.store_id] : []),\n    active: row.active !== false,\n    createdAt: row.created_at,\n    lastSeen,\n    isOnline,\n  };\n}\n\nfunction mapCompanyRow(row: DbCompany): Company {\n  return {\n    id: row.id,\n    name: row.name,\n    tradingName: row.trading_name ?? undefined,\n    cnpj: row.cnpj ?? undefined,\n    active: row.active !== false,\n    createdAt: row.created_at,\n    updatedAt: row.updated_at,\n  };\n}\n\nfunction mapStoreRow(row: DbStore): Store {\n  return {\n    id: row.id,\n    name: row.name,\n    code: row.code,\n    companyId: row.company_id,\n    managerId: row.manager_id ?? null,\n    agentId: row.agent_id ?? null,\n    address: row.address ?? undefined,\n    city: row.city ?? undefined,\n    state: row.state ?? undefined,\n    active: row.active !== false,\n    createdAt: row.created_at,\n    updatedAt: row.updated_at,\n  };\n}\n\n/**\n * Helper Functions para opera‡äes comuns\n */\n\n// ========================================\n// USERS\n// ========================================\n\nexport async function getAllUsers() {\n  const { data, error } = await supabaseAdmin\n    .from('users')\n    .select('*')\n    .order('created_at', { ascending: false });\n\n  if (error) throw error;\n  return (data || []).map(mapUserRow);\n}\n\nexport async function getUserById(userId: string) {\n  const { data, error } = await supabaseAdmin\n    .from('users')\n    .select('*')\n    .eq('id', userId)\n    .single();\n\n  if (error) throw error;\n  return mapUserRow(data as DbUser);\n}\n\nexport async function getUsersByCompany(companyId: string) {\n  const { data, error } = await supabaseAdmin\n    .from('users')\n    .select('*')\n    .eq('company_id', companyId)\n    .order('created_at', { ascending: false });\n\n  if (error) throw error;\n  return (data || []).map(mapUserRow);\n}\n\nexport async function createUser(user: Partial<User>) {\n  const payload = {\n    id: user.id,\n    email: user.email,\n    display_name: user.displayName ?? null,\n    role: user.role,\n    company_id: user.companyId ?? null,\n    store_id: user.storeId ?? null,\n    store_ids: user.storeIds ?? (user.storeId ? [user.storeId] : []),\n    active: user.active ?? true,\n  };\n  const { data, error } = await supabaseAdmin\n    .from('users')\n    .insert(payload)\n    .select()\n    .single();\n\n  if (error) throw error;\n  return mapUserRow(data as DbUser);\n}\n\nexport async function updateUser(userId: string, updates: Partial<User>) {\n  const payload: Partial<DbUser> & { updated_at?: string } = {\n    display_name: updates.displayName,\n    role: updates.role,\n    company_id: updates.companyId ?? undefined,\n    store_id: updates.storeId ?? undefined,\n    store_ids: updates.storeIds,\n    active: typeof updates.active === 'boolean' ? updates.active : undefined,\n    updated_at: new Date().toISOString(),\n  };\n  const { data, error } = await supabaseAdmin\n    .from('users')\n    .update(payload)\n    .eq('id', userId)\n    .select()\n    .single();\n\n  if (error) throw error;\n  return mapUserRow(data as DbUser);\n}\n\nexport async function deleteUser(userId: string) {\n  const { error } = await supabaseAdmin\n    .from('users')\n    .delete()\n    .eq('id', userId);\n\n  if (error) throw error;\n}\n\n// ========================================\n// COMPANIES\n// ========================================\n\nexport async function getAllCompanies() {\n  const { data, error } = await supabaseAdmin\n    .from('companies')\n    .select('*')\n    .order('name', { ascending: true });\n\n  if (error) throw error;\n  return (data || []).map(mapCompanyRow);\n}\n\nexport async function getCompanyById(companyId: string) {\n  const { data, error } = await supabaseAdmin\n    .from('companies')\n    .select('*')\n    .eq('id', companyId)\n    .single();\n\n  if (error) throw error;\n  return mapCompanyRow(data as DbCompany);\n}\n\nexport async function createCompany(company: Partial<Company>) {\n  const payload = {\n    id: company.id,\n    name: company.name,\n    trading_name: company.tradingName ?? null,\n    cnpj: company.cnpj ?? null,\n    active: company.active ?? true,\n  };\n  const { data, error } = await supabaseAdmin\n    .from('companies')\n    .insert(payload)\n    .select()\n    .single();\n\n  if (error) throw error;\n  return mapCompanyRow(data as DbCompany);\n}\n\nexport async function updateCompany(companyId: string, updates: Partial<Company>) {\n  const payload = {\n    name: updates.name,\n    trading_name: updates.tradingName ?? undefined,\n    cnpj: updates.cnpj ?? undefined,\n    active: typeof updates.active === 'boolean' ? updates.active : undefined,\n    updated_at: new Date().toISOString(),\n  };\n  const { data, error } = await supabaseAdmin\n    .from('companies')\n    .update(payload)\n    .eq('id', companyId)\n    .select()\n    .single();\n\n  if (error) throw error;\n  return mapCompanyRow(data as DbCompany);\n}\n\n// ========================================\n// STORES\n// ========================================\n\nexport async function getAllStores() {\n  const { data, error } = await supabaseAdmin\n    .from('stores')\n    .select('*')\n    .order('name', { ascending: true });\n\n  if (error) throw error;\n  return (data || []).map(mapStoreRow);\n}\n\nexport async function getStoresByCompany(companyId: string) {\n  const { data, error } = await supabaseAdmin\n    .from('stores')\n    .select('*')\n    .eq('company_id', companyId)\n    .order('name', { ascending: true });\n\n  if (error) throw error;\n  return (data || []).map(mapStoreRow);\n}\n\nexport async function getStoreById(storeId: string) {\n  const { data, error } = await supabaseAdmin\n    .from('stores')\n    .select('*')\n    .eq('id', storeId)\n    .single();\n\n  if (error) throw error;\n  return mapStoreRow(data as DbStore);\n}\n\nexport async function createStore(store: Partial<Store>) {\n  const payload = {\n    id: store.id,\n    name: store.name,\n    code: store.code,\n    company_id: store.companyId,\n    manager_id: store.managerId ?? null,\n    agent_id: store.agentId ?? null,\n    address: store.address ?? null,\n    city: store.city ?? null,\n    state: store.state ?? null,\n    active: store.active ?? true,\n  };\n  const { data, error } = await supabaseAdmin\n    .from('stores')\n    .insert(payload)\n    .select()\n    .single();\n\n  if (error) throw error;\n  return mapStoreRow(data as DbStore);\n}\n\nexport async function updateStore(storeId: string, updates: Partial<Store>) {\n  const payload = {\n    name: updates.name,\n    code: updates.code,\n    company_id: updates.companyId,\n    manager_id: updates.managerId ?? undefined,\n    agent_id: updates.agentId ?? undefined,\n    address: updates.address ?? undefined,\n    city: updates.city ?? undefined,\n    state: updates.state ?? undefined,\n    active: typeof updates.active === 'boolean' ? updates.active : undefined,\n    updated_at: new Date().toISOString(),\n  };\n  const { data, error } = await supabaseAdmin\n    .from('stores')\n    .update(payload)\n    .eq('id', storeId)\n    .select()\n    .single();\n\n  if (error) throw error;\n  return mapStoreRow(data as DbStore);\n}\n\n/**\n * Helper para verificar JWT token do usu rio\n */\nexport async function verifyToken(token: string) {\n  const { data: { user }, error } = await supabaseAdmin.auth.getUser(token);\n\n  if (error) throw error;\n  return user;\n}\n\nexport default supabaseAdmin;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 276, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 282, "column": 0}, "map": {"version":3,"sources":["turbopack://[project]/app/api/dashboard/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { supabaseAdmin } from '@/lib/supabase-admin';\n\n// Força a rota a ser dinâmica e não fazer cache\nexport const dynamic = 'force-dynamic';\nexport const revalidate = 0;\n\nexport async function GET() {\n  console.log('[DASHBOARD] GET request received');\n\n  try {\n    console.log('[DASHBOARD] Starting data fetch');\n    const now = new Date();\n    const thirtyDaysAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);\n    const sevenDaysAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);\n    const yesterday = new Date(now.getTime() - 24 * 60 * 60 * 1000);\n    const todayStart = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n\n    // Buscar todas as solicitações (excluindo rascunhos)\n    const { data: solicitacoesDataResponse, error: solicitacoesError } = await supabaseAdmin\n      .from('solicitacoes')\n      .select('*')\n      .neq('status', 'draft');\n\n    let solicitacoesData: any[] = [];\n    if (solicitacoesError) {\n      if (solicitacoesError.code === 'PGRST205') {\n        console.warn('[DASHBOARD] Tabela solicitacoes não encontrada, retornando dados vazios.');\n      } else {\n        throw solicitacoesError;\n      }\n    } else {\n      solicitacoesData = solicitacoesDataResponse || [];\n    }\n\n    const totalSolicitacoes = solicitacoesData.length;\n\n    // Contar solicitações por status\n    const statusCounters = {\n      pending: 0,\n      batched: 0,\n      closed: 0,\n    };\n\n    const solicitacoesRecentes: any[] = [];\n    const solicitacoesPorDia: { [key: string]: number } = {};\n    const produtosContagem: Record<string, { count: number; name: string; ean?: string }> = {};\n\n    // Rankings: contagem de itens\n    const itensPorLoja: Record<string, { count: number; name: string }> = {};\n    const itensPorComprador: Record<string, { count: number; name: string }> = {};\n    const itensPorProduto: Record<string, { count: number; name: string; ean?: string }> = {};\n\n    // Cache de usuários, lojas e produtos para evitar consultas duplicadas\n    const usersCache: Record<string, { name: string; role: string } | null> = {};\n    const storesCache: Record<string, string> = {};\n    const produtoCache = new Map<string, { name: string; ean?: string; comprador?: string }>();\n\n    const getUserName = async (userId?: string): Promise<string> => {\n      if (!userId) return 'Desconhecido';\n\n      if (usersCache[userId] !== undefined) {\n        return usersCache[userId]?.name || 'Desconhecido';\n      }\n\n      try {\n        const { data, error } = await supabaseAdmin\n          .from('users')\n          .select('display_name, role')\n          .eq('id', userId)\n          .single();\n\n        if (!error && data) {\n          const userName = data.display_name || 'Desconhecido';\n          usersCache[userId] = { name: userName, role: data.role || 'unknown' };\n          return userName;\n        }\n      } catch (error) {\n        console.error('Error fetching user:', userId, error);\n      }\n\n      usersCache[userId] = null;\n      return 'Desconhecido';\n    };\n\n    const getStoreName = async (storeId?: string): Promise<string> => {\n      if (!storeId) return 'Desconhecida';\n\n      if (storesCache[storeId]) return storesCache[storeId];\n\n      try {\n        const { data, error } = await supabaseAdmin\n          .from('stores')\n          .select('name')\n          .eq('id', storeId)\n          .single();\n\n        if (!error && data) {\n          storesCache[storeId] = data.name;\n          return data.name;\n        }\n      } catch (error) {\n        console.error('Error fetching store:', error);\n      }\n\n      storesCache[storeId] = 'Desconhecida';\n      return 'Desconhecida';\n    };\n\n    const getProdutoInfo = async (productId?: string, ean?: string) => {\n      const cacheKey = productId || (ean ? `ean:${ean}` : undefined);\n      if (cacheKey && produtoCache.has(cacheKey)) return produtoCache.get(cacheKey);\n\n      let data: any | undefined;\n\n      // Buscar por ID primeiro\n      if (productId) {\n        try {\n          const { data: prodData, error } = await supabaseAdmin\n            .from('products')\n            .select('*')\n            .eq('id', productId)\n            .single();\n\n          if (!error && prodData) data = prodData;\n        } catch (error) {\n          console.error('Error fetching product by id:', error);\n        }\n      }\n\n      // Se não encontrou, buscar por EAN\n      if (!data && ean) {\n        try {\n          const { data: prodData, error } = await supabaseAdmin\n            .from('products')\n            .select('*')\n            .or(`id.eq.${ean},ean.eq.${ean}`)\n            .limit(1)\n            .single();\n\n          if (!error && prodData) data = prodData;\n        } catch (error) {\n          console.error('Error fetching product by EAN:', error);\n        }\n      }\n\n      if (!data) return undefined;\n\n      const info = {\n        name: data.nome || data.name || data.descricao || data.description || data.ean || 'Produto Desconhecido',\n        ean: data.ean || ean,\n        comprador: data.comprador || data.buyer || data.comprador_id || data.buyer_id,\n      };\n\n      if (cacheKey) produtoCache.set(cacheKey, info);\n      return info;\n    };\n\n    let solicitacoesHoje = 0;\n    let solicitacoesOntem = 0;\n    let solicitacoesUltimos7Dias = 0;\n    let solicitacoesUltimos7a14Dias = 0;\n    let totalItens = 0;\n\n    // Métricas financeiras\n    let valorTotalSolicitado = 0;      // Total R$ de todos os itens solicitados\n    let valorTotalAprovado = 0;        // Total R$ de itens aprovados (economia gerada)\n    let valorTotalRejeitado = 0;       // Total R$ de itens rejeitados\n    let valorTotalPendente = 0;        // Total R$ de itens pendentes\n    let itensAprovados = 0;\n    let itensRejeitados = 0;\n    let itensPendentes = 0;\n\n    // Dados para projeção financeira\n    const valorPorDia: { [key: string]: number } = {};\n    const itensPorDiaStatus: { [key: string]: { approved: number; rejected: number; pending: number } } = {};\n\n    // Processar cada solicitação\n    for (const solicitacao of solicitacoesData || []) {\n      const status = ['pending', 'batched', 'closed'].includes(String(solicitacao.status))\n        ? solicitacao.status\n        : 'pending';\n\n      if (status in statusCounters) statusCounters[status as keyof typeof statusCounters]++;\n\n      // Adicionar solicitações recentes (até 10)\n      if (solicitacoesRecentes.length < 10) {\n        const createdAt = new Date(solicitacao.created_at || new Date());\n        const userName = await getUserName(solicitacao.created_by);\n        const storeName = await getStoreName(solicitacao.store_id);\n\n        solicitacoesRecentes.push({\n          id: solicitacao.id,\n          status,\n          createdAt: createdAt.toISOString(),\n          userName,\n          storeName,\n          storeId: solicitacao.store_id,\n        });\n      }\n\n      // Contar solicitações por dia (últimos 30 dias)\n      const createdAt = new Date(solicitacao.created_at);\n      if (createdAt >= thirtyDaysAgo) {\n        const dateKey = createdAt.toISOString().split('T')[0];\n        solicitacoesPorDia[dateKey] = (solicitacoesPorDia[dateKey] || 0) + 1;\n      }\n\n      // Contar solicitações por período\n      if (createdAt >= todayStart) solicitacoesHoje++;\n      if (createdAt >= yesterday && createdAt < todayStart) solicitacoesOntem++;\n      if (createdAt >= sevenDaysAgo) solicitacoesUltimos7Dias++;\n      if (createdAt >= new Date(now.getTime() - 14 * 24 * 60 * 60 * 1000) && createdAt < sevenDaysAgo) {\n        solicitacoesUltimos7a14Dias++;\n      }\n\n      // Buscar itens da solicitação (substituindo subcollection por foreign key)\n      try {\n        const { data: itensData, error: itensError } = await supabaseAdmin\n          .from('solicitacao_itens')\n          .select('*')\n          .eq('solicitacao_id', solicitacao.id);\n\n        if (itensError || !itensData) continue;\n\n        const storeId = solicitacao.store_id;\n\n        for (const item of itensData) {\n          // Suportar tanto productId quanto EAN direto no item\n          let productId = item.product_id || item.produto_id;\n          const ean = item.ean;\n          const descricao = item.descricao || item.description || item.nome || item.name;\n\n          // Se não tem productId mas tem EAN, usar o EAN como identificador\n          if (!productId && ean) {\n            productId = ean;\n          }\n\n          // Se não tem nem productId nem EAN, usar a descrição como identificador\n          if (!productId && descricao) {\n            productId = `desc_${descricao.toLowerCase().replace(/[^a-z0-9]+/g, '_').substring(0, 50)}`;\n          }\n\n          // Buscar informações do produto para obter o comprador correto\n          const produtoInfo = await getProdutoInfo(productId, ean);\n\n          // PRIORIZAR o comprador do PRODUTO, depois item\n          let compradorKey: string | undefined;\n          let compradorNome: string | undefined;\n\n          if (produtoInfo?.comprador) {\n            const compradorValue = String(produtoInfo.comprador);\n            compradorKey = compradorValue;\n\n            // Verificar se parece ser um ID de usuário ou um nome direto\n            if (compradorValue.length > 20 || compradorValue.includes('-')) {\n              compradorNome = await getUserName(compradorValue);\n            } else {\n              compradorNome = compradorValue;\n            }\n          } else {\n            const compradorId = item.comprador || item.comprador_id || item.buyer_id;\n            if (compradorId) {\n              const compradorValue = String(compradorId);\n              compradorKey = compradorValue;\n\n              if (compradorValue.length > 20 || compradorValue.includes('-')) {\n                compradorNome = await getUserName(compradorValue);\n              } else {\n                compradorNome = compradorValue;\n              }\n            } else {\n              compradorKey = 'sem_comprador';\n              compradorNome = 'Sem Comprador Definido';\n            }\n          }\n\n          // Só processar se tiver algum identificador\n          if (productId) {\n            totalItens++;\n\n            // Calcular valor do item (preço * quantidade)\n            const precoAtual = parseFloat(item.preco_atual) || 0;\n            const quantidade = parseInt(item.qtd) || parseInt(item.quantidade) || 1;\n            const valorItem = precoAtual * quantidade;\n            const itemStatus = item.status || 'pending';\n\n            // Métricas financeiras por status do item\n            valorTotalSolicitado += valorItem;\n\n            if (itemStatus === 'approved') {\n              valorTotalAprovado += valorItem;\n              itensAprovados++;\n            } else if (itemStatus === 'rejected') {\n              valorTotalRejeitado += valorItem;\n              itensRejeitados++;\n            } else {\n              valorTotalPendente += valorItem;\n              itensPendentes++;\n            }\n\n            // Acumular valor por dia para projeção\n            const itemDate = new Date(item.created_at || solicitacao.created_at);\n            const itemDateKey = itemDate.toISOString().split('T')[0];\n            if (itemDate >= thirtyDaysAgo) {\n              valorPorDia[itemDateKey] = (valorPorDia[itemDateKey] || 0) + valorItem;\n\n              if (!itensPorDiaStatus[itemDateKey]) {\n                itensPorDiaStatus[itemDateKey] = { approved: 0, rejected: 0, pending: 0 };\n              }\n              if (itemStatus === 'approved') {\n                itensPorDiaStatus[itemDateKey].approved++;\n              } else if (itemStatus === 'rejected') {\n                itensPorDiaStatus[itemDateKey].rejected++;\n              } else {\n                itensPorDiaStatus[itemDateKey].pending++;\n              }\n            }\n\n            // Contagem de produtos\n            if (!produtosContagem[productId]) {\n              const productName = produtoInfo?.name || descricao || 'Produto Desconhecido';\n              const productEan = produtoInfo?.ean || ean;\n              produtosContagem[productId] = { count: 0, name: productName, ean: productEan };\n            }\n            produtosContagem[productId].count++;\n\n            // Ranking por produto\n            if (!itensPorProduto[productId]) {\n              const productName = produtoInfo?.name || descricao || 'Produto Desconhecido';\n              const productEan = produtoInfo?.ean || ean;\n              itensPorProduto[productId] = { count: 0, name: productName, ean: productEan };\n            }\n            itensPorProduto[productId].count++;\n\n            // Ranking por loja\n            if (storeId) {\n              if (!itensPorLoja[storeId]) {\n                const storeName = await getStoreName(storeId);\n                itensPorLoja[storeId] = { count: 0, name: storeName };\n              }\n              itensPorLoja[storeId].count++;\n            }\n\n            // Ranking por comprador\n            if (compradorKey) {\n              if (!itensPorComprador[compradorKey]) {\n                itensPorComprador[compradorKey] = { count: 0, name: compradorNome || 'Comprador Desconhecido' };\n              }\n              itensPorComprador[compradorKey].count++;\n            }\n          }\n        }\n      } catch (error) {\n        console.error('Error fetching items for solicitação:', solicitacao.id, error);\n      }\n    }\n\n    // Ordenar solicitações recentes por data\n    solicitacoesRecentes.sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\n\n    // Buscar todos os usuários\n    const { data: usersData, error: usersError } = await supabaseAdmin\n      .from('users')\n      .select('*');\n\n    if (usersError) throw usersError;\n\n    const totalUsuarios = usersData?.length || 0;\n    const usuariosAtivos = usersData?.filter((u: any) => u.active !== false).length || 0;\n\n    // Contar solicitações por loja\n    const solicitacoesPorLojaMap: Record<string, { count: number; name: string }> = {};\n\n    for (const sol of solicitacoesData || []) {\n      const storeId = sol.store_id;\n\n      if (storeId) {\n        if (!solicitacoesPorLojaMap[storeId]) {\n          const storeName = await getStoreName(storeId);\n          solicitacoesPorLojaMap[storeId] = { count: 0, name: storeName };\n        }\n        solicitacoesPorLojaMap[storeId].count++;\n      }\n    }\n\n    // Converter para array e ordenar por contagem\n    const solicitacoesPorLoja = Object.entries(solicitacoesPorLojaMap)\n      .map(([storeId, data]) => ({\n        storeId,\n        storeName: data.name,\n        count: data.count,\n      }))\n      .sort((a, b) => b.count - a.count);\n\n    // Buscar lojas\n    const { data: storesData, error: storesError } = await supabaseAdmin\n      .from('stores')\n      .select('*');\n\n    if (storesError) throw storesError;\n\n    const totalLojas = storesData?.length || 0;\n\n    // Lojas com 50+ profissionais\n    const usuariosPorLoja: Record<string, number> = {};\n    usersData?.forEach((u: any) => {\n      const storeKey = u.store_id || u.loja_id || u.store || u.loja;\n      if (storeKey) {\n        const key = String(storeKey);\n        usuariosPorLoja[key] = (usuariosPorLoja[key] || 0) + 1;\n      }\n    });\n    const lojasCom50MaisProfissionais = Object.values(usuariosPorLoja).filter((n) => n >= 50).length;\n\n    // Converter solicitações por dia em array para gráfico\n    const chartData = Object.entries(solicitacoesPorDia)\n      .map(([date, count]) => ({ date, count }))\n      .sort((a, b) => a.date.localeCompare(b.date));\n\n    // Calcular KPIs adicionais\n    const mediaItensPorSolicitacao = totalSolicitacoes > 0 ? (totalItens / totalSolicitacoes).toFixed(1) : '0';\n    const solicitacoesProcessadas = statusCounters.closed + statusCounters.batched;\n    const taxaConversao = totalSolicitacoes > 0 ? Number(((solicitacoesProcessadas / totalSolicitacoes) * 100).toFixed(1)) : 0;\n    const mudancaHoje = solicitacoesOntem > 0 ? (((solicitacoesHoje - solicitacoesOntem) / solicitacoesOntem) * 100).toFixed(0) : '0';\n    const mudancaSemanal = solicitacoesUltimos7a14Dias > 0 ? (((solicitacoesUltimos7Dias - solicitacoesUltimos7a14Dias) / solicitacoesUltimos7a14Dias) * 100).toFixed(0) : '0';\n\n    // Top produtos mais solicitados\n    const topProdutos = Object.entries(produtosContagem)\n      .map(([productId, data]) => ({\n        productId,\n        productName: data.name,\n        count: data.count,\n        ean: data.ean,\n      }))\n      .sort((a, b) => b.count - a.count)\n      .slice(0, 10);\n\n    // Preparar dados de comparação de períodos (últimos 14 dias vs 14 dias anteriores)\n    const periodComparisonData: Array<{ date: string; current: number; previous: number }> = [];\n\n    for (let i = 0; i < 14; i++) {\n      const currentDate = new Date(now.getTime() - i * 24 * 60 * 60 * 1000);\n      const previousDate = new Date(now.getTime() - (i + 14) * 24 * 60 * 60 * 1000);\n\n      const currentKey = currentDate.toISOString().split('T')[0];\n      const previousKey = previousDate.toISOString().split('T')[0];\n\n      periodComparisonData.unshift({\n        date: currentKey,\n        current: solicitacoesPorDia[currentKey] || 0,\n        previous: solicitacoesPorDia[previousKey] || 0,\n      });\n    }\n\n    // Gerar insights automáticos\n    const insights: Array<{\n      type: 'success' | 'warning' | 'info' | 'alert';\n      title: string;\n      description: string;\n      icon: 'trending-up' | 'trending-down' | 'alert' | 'check' | 'info' | 'zap';\n    }> = [];\n\n    // Insight 1: Tendência de crescimento\n    if (parseFloat(mudancaSemanal) > 10) {\n      insights.push({\n        type: 'success',\n        title: 'Crescimento Acelerado',\n        description: `As solicitações cresceram ${mudancaSemanal}% na última semana comparado à semana anterior.`,\n        icon: 'trending-up',\n      });\n    } else if (parseFloat(mudancaSemanal) < -10) {\n      insights.push({\n        type: 'warning',\n        title: 'Redução de Atividade',\n        description: `As solicitações reduziram ${Math.abs(parseFloat(mudancaSemanal))}% na última semana.`,\n        icon: 'trending-down',\n      });\n    }\n\n    // Insight 2: Taxa de processamento\n    const taxaConversaoNum = taxaConversao;\n    if (taxaConversaoNum >= 95) {\n      insights.push({\n        type: 'success',\n        title: 'Taxa de Processamento Excelente',\n        description: `${taxaConversaoNum.toFixed(1)}% das solicitações foram processadas (em análise ou concluídas).`,\n        icon: 'check',\n      });\n    } else if (taxaConversaoNum >= 70) {\n      insights.push({\n        type: 'info',\n        title: 'Taxa de Processamento Sólida',\n        description: `${taxaConversaoNum.toFixed(1)}% das solicitações já estão processadas. Mantenha o ritmo para chegar em 95%+.`,\n        icon: 'trending-up',\n      });\n    } else if (taxaConversaoNum < 50) {\n      insights.push({\n        type: 'alert',\n        title: 'Taxa de Processamento Baixa',\n        description: `Apenas ${taxaConversaoNum.toFixed(1)}% das solicitações foram processadas. Revise o fluxo para destravar a fila.`,\n        icon: 'alert',\n      });\n    }\n\n    // Insight 3: Solicitações pendentes\n    const totalPendentes = statusCounters.pending;\n    const totalEmAnalise = statusCounters.batched;\n\n    if (totalPendentes === 0 && totalEmAnalise === 0) {\n      insights.push({\n        type: 'success',\n        title: 'Tudo Processado',\n        description: 'Não há solicitações pendentes. Todas foram analisadas.',\n        icon: 'check',\n      });\n    } else if (totalPendentes > 0 && totalPendentes > totalSolicitacoes * 0.3) {\n      insights.push({\n        type: 'warning',\n        title: 'Alto Volume Pendente',\n        description: `Existem ${totalPendentes} solicitações aguardando envio para análise (${((totalPendentes / totalSolicitacoes) * 100).toFixed(0)}% do total).`,\n        icon: 'alert',\n      });\n    } else if (totalEmAnalise > 0) {\n      insights.push({\n        type: 'info',\n        title: 'Solicitações em Análise',\n        description: `${totalEmAnalise} solicitação(ões) agrupada(s) em ficha aguardando fechamento.`,\n        icon: 'info',\n      });\n    }\n\n    // Insight 4: Atividade de hoje\n    if (solicitacoesHoje > solicitacoesOntem) {\n      insights.push({\n        type: 'info',\n        title: 'Dia Mais Ativo',\n        description: `Hoje já foram registradas ${solicitacoesHoje} solicitações, ${solicitacoesHoje - solicitacoesOntem} a mais que ontem.`,\n        icon: 'zap',\n      });\n    }\n\n    // Insight 5: Top produto\n    if (topProdutos.length > 0) {\n      insights.push({\n        type: 'info',\n        title: 'Produto Mais Solicitado',\n        description: `\"${topProdutos[0].productName}\" lidera com ${topProdutos[0].count} solicitações.`,\n        icon: 'info',\n      });\n    }\n\n    // Insight 6: Concentração de atividade por loja\n    if (Object.keys(itensPorLoja).length > 0) {\n      const lojasSorted = Object.entries(itensPorLoja).sort((a, b) => b[1].count - a[1].count);\n      const topLoja = lojasSorted[0];\n      const totalItensLojas = lojasSorted.reduce((sum, [_, data]) => sum + data.count, 0);\n      const percentualTopLoja = ((topLoja[1].count / totalItensLojas) * 100).toFixed(0);\n\n      if (parseFloat(percentualTopLoja) > 40) {\n        insights.push({\n          type: 'warning',\n          title: 'Alta Concentração em Uma Loja',\n          description: `A loja \"${topLoja[1].name}\" representa ${percentualTopLoja}% de todos os itens solicitados. Considere distribuir melhor as demandas.`,\n          icon: 'alert',\n        });\n      } else if (lojasSorted.length >= 3) {\n        const top3Total = lojasSorted.slice(0, 3).reduce((sum, [_, data]) => sum + data.count, 0);\n        const percentualTop3 = ((top3Total / totalItensLojas) * 100).toFixed(0);\n\n        insights.push({\n          type: 'success',\n          title: 'Distribuição Equilibrada',\n          description: `As top 3 lojas representam ${percentualTop3}% das solicitações, indicando boa distribuição de atividade no sistema.`,\n          icon: 'check',\n        });\n      }\n    }\n\n    // Preparar rankings (Top 50)\n    const rankingPorLoja = Object.entries(itensPorLoja)\n      .map(([id, data]) => ({\n        id,\n        name: data.name,\n        count: data.count,\n      }))\n      .sort((a, b) => b.count - a.count)\n      .slice(0, 50);\n\n    const rankingPorComprador = Object.entries(itensPorComprador)\n      .map(([id, data]) => ({\n        id,\n        name: data.name,\n        count: data.count,\n      }))\n      .sort((a, b) => b.count - a.count)\n      .slice(0, 50);\n\n    const rankingPorProduto = Object.entries(itensPorProduto)\n      .map(([id, data]) => {\n        let details = undefined;\n        if (data.ean) {\n          details = `EAN: ${data.ean}`;\n        } else if (id.startsWith('desc_')) {\n          details = 'Produto sem código de barras';\n        } else {\n          details = `ID: ${id}`;\n        }\n        return {\n          id,\n          name: data.name,\n          count: data.count,\n          details,\n        };\n      })\n      .sort((a, b) => b.count - a.count)\n      .slice(0, 50);\n\n    // Calcular taxas de aprovação/rejeição\n    const totalItensProcessados = itensAprovados + itensRejeitados + itensPendentes;\n    const taxaAprovacao = totalItensProcessados > 0 ? Number(((itensAprovados / totalItensProcessados) * 100).toFixed(1)) : 0;\n    const taxaRejeicao = totalItensProcessados > 0 ? Number(((itensRejeitados / totalItensProcessados) * 100).toFixed(1)) : 0;\n\n    // Dados para gráfico de projeção financeira (últimos 30 dias + projeção 7 dias)\n    const valorChartData = Object.entries(valorPorDia)\n      .map(([date, valor]) => ({ date, valor: Number(valor.toFixed(2)) }))\n      .sort((a, b) => a.date.localeCompare(b.date));\n\n    // Calcular média dos últimos 7 dias para projeção\n    const ultimosValores = valorChartData.slice(-7);\n    const mediaValorDiario = ultimosValores.length > 0\n      ? ultimosValores.reduce((sum, d) => sum + d.valor, 0) / ultimosValores.length\n      : 0;\n\n    // Gerar projeção para os próximos 7 dias\n    const projecaoFinanceira: Array<{ date: string; valor: number; projetado: boolean }> = [];\n\n    // Adicionar dados históricos\n    valorChartData.forEach(d => {\n      projecaoFinanceira.push({ date: d.date, valor: d.valor, projetado: false });\n    });\n\n    // Adicionar projeção\n    for (let i = 1; i <= 7; i++) {\n      const futureDate = new Date(now.getTime() + i * 24 * 60 * 60 * 1000);\n      const futureDateKey = futureDate.toISOString().split('T')[0];\n      // Aplicar tendência de crescimento na projeção\n      const tendencia = parseFloat(mudancaSemanal) / 100;\n      const valorProjetado = mediaValorDiario * (1 + (tendencia * i / 7));\n      projecaoFinanceira.push({\n        date: futureDateKey,\n        valor: Number(valorProjetado.toFixed(2)),\n        projetado: true,\n      });\n    }\n\n    // Dados de status de itens por dia para gráfico\n    const itensStatusChartData = Object.entries(itensPorDiaStatus)\n      .map(([date, status]) => ({\n        date,\n        aprovados: status.approved,\n        rejeitados: status.rejected,\n        pendentes: status.pending,\n      }))\n      .sort((a, b) => a.date.localeCompare(b.date));\n\n    // Análise de Pareto financeira (top produtos por valor)\n    const produtosComValor: Record<string, { count: number; name: string; valor: number; ean?: string }> = {};\n\n    // Calcular valor total por produto (necessário nova iteração)\n    for (const solicitacao of solicitacoesData || []) {\n      try {\n        const { data: itensData } = await supabaseAdmin\n          .from('solicitacao_itens')\n          .select('*')\n          .eq('solicitacao_id', solicitacao.id);\n\n        if (!itensData) continue;\n\n        for (const item of itensData) {\n          let productId = item.product_id || item.produto_id || item.ean;\n          const descricao = item.descricao || item.description || item.nome;\n\n          if (!productId && descricao) {\n            productId = `desc_${descricao.toLowerCase().replace(/[^a-z0-9]+/g, '_').substring(0, 50)}`;\n          }\n\n          if (productId) {\n            const precoAtual = parseFloat(item.preco_atual) || 0;\n            const quantidade = parseInt(item.qtd) || parseInt(item.quantidade) || 1;\n            const valorItem = precoAtual * quantidade;\n\n            if (!produtosComValor[productId]) {\n              produtosComValor[productId] = {\n                count: 0,\n                name: descricao || 'Produto Desconhecido',\n                valor: 0,\n                ean: item.ean,\n              };\n            }\n            produtosComValor[productId].count++;\n            produtosComValor[productId].valor += valorItem;\n          }\n        }\n      } catch (error) {\n        // Silently continue\n      }\n    }\n\n    // Ordenar por valor para Pareto\n    const paretoFinanceiro = Object.entries(produtosComValor)\n      .map(([id, data]) => ({\n        productId: id,\n        productName: data.name,\n        count: data.count,\n        valor: Number(data.valor.toFixed(2)),\n        ean: data.ean,\n      }))\n      .sort((a, b) => b.valor - a.valor)\n      .slice(0, 20);\n\n    // Calcular percentual acumulado para Pareto\n    const valorTotalPareto = paretoFinanceiro.reduce((sum, p) => sum + p.valor, 0);\n    let acumuladoPareto = 0;\n    const paretoComAcumulado = paretoFinanceiro.map(p => {\n      acumuladoPareto += p.valor;\n      return {\n        ...p,\n        percentualAcumulado: valorTotalPareto > 0 ? Number(((acumuladoPareto / valorTotalPareto) * 100).toFixed(1)) : 0,\n      };\n    });\n\n    // Preparar resposta\n    const dashboardData = {\n      kpis: {\n        totalSolicitacoes,\n        totalUsuarios,\n        usuariosAtivos,\n        totalLojas,\n        totalItens,\n        lojasCom50MaisProfissionais,\n        solicitacoesHoje,\n        solicitacoesOntem,\n        mediaItensPorSolicitacao: parseFloat(mediaItensPorSolicitacao),\n        taxaConversao,\n        solicitacoesUltimos7Dias,\n        mudancaSemanal: parseFloat(mudancaSemanal),\n      },\n      // Novas métricas financeiras\n      financeiro: {\n        valorTotalSolicitado: Number(valorTotalSolicitado.toFixed(2)),\n        valorTotalAprovado: Number(valorTotalAprovado.toFixed(2)),\n        valorTotalRejeitado: Number(valorTotalRejeitado.toFixed(2)),\n        valorTotalPendente: Number(valorTotalPendente.toFixed(2)),\n        itensAprovados,\n        itensRejeitados,\n        itensPendentes,\n        taxaAprovacao,\n        taxaRejeicao,\n        mediaValorDiario: Number(mediaValorDiario.toFixed(2)),\n        projecaoSemanal: Number((mediaValorDiario * 7).toFixed(2)),\n      },\n      solicitacoesPorStatus: statusCounters,\n      solicitacoesPorLoja,\n      solicitacoesRecentes,\n      chartData,\n      topProdutos,\n      periodComparisonData,\n      insights,\n      rankingPorLoja,\n      rankingPorComprador,\n      rankingPorProduto,\n      // Novos dados para gráficos\n      projecaoFinanceira,\n      itensStatusChartData,\n      paretoFinanceiro: paretoComAcumulado,\n      valorChartData,\n      lastUpdated: new Date().toISOString(),\n    };\n\n    return NextResponse.json(dashboardData, {\n      headers: {\n        'Cache-Control': 'no-store, no-cache, must-revalidate, max-age=0',\n        'Pragma': 'no-cache',\n        'Expires': '0',\n      },\n    });\n  } catch (error: any) {\n    console.error('[DASHBOARD] Error fetching dashboard data:', error);\n    console.error('[DASHBOARD] Error message:', error?.message);\n    console.error('[DASHBOARD] Error code:', error?.code);\n    console.error('[DASHBOARD] Error details:', error?.details);\n    return NextResponse.json({\n      error: 'Failed to fetch dashboard data',\n      details: error?.message || 'Unknown error',\n      code: error?.code || 'UNKNOWN'\n    }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 956, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}