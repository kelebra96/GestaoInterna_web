{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["turbopack://[project]/lib/prisma.ts"],"sourcesContent":["// lib/prisma.ts\nimport { PrismaClient } from '@prisma/client';\n\n// PrismaClient is attached to the `global` object in development to prevent\n// exhausting your database connection limit.\n//\n// Learn more: https://pris.ly/d/help/next-js-best-practices\n\n// Extend global to include prisma\ndeclare global {\n  var prisma: PrismaClient | undefined;\n}\n\nlet prisma: PrismaClient;\n\nif (process.env.NODE_ENV === 'production') {\n  prisma = new PrismaClient();\n} else {\n  if (!global.prisma) {\n    global.prisma = new PrismaClient();\n  }\n  prisma = global.prisma;\n}\n\nexport default prisma;\n"],"names":[],"mappings":"AAAA,gBAAgB;;;;AAChB;;AAYA,IAAI;AAEJ,uCAA2C;;AAE3C,OAAO;IACL,IAAI,CAAC,OAAO,MAAM,EAAE;QAClB,OAAO,MAAM,GAAG,IAAI,2GAAA,CAAA,eAAY;IAClC;IACA,SAAS,OAAO,MAAM;AACxB;uCAEe"}},
    {"offset": {"line": 71, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 109, "column": 0}, "map": {"version":3,"sources":["turbopack://[project]/app/api/auth/login/route.ts"],"sourcesContent":["// web/app/api/auth/login/route.ts\nimport { NextResponse } from 'next/server';\nimport prisma from '@/lib/prisma';\nimport * as bcrypt from 'bcryptjs';\nimport jwt from 'jsonwebtoken';\nimport { z } from 'zod';\n\n// Zod schema for login payload\nconst loginSchema = z.object({\n  email: z.string().email(\"Invalid email address\"),\n  password: z.string().min(1, \"Password is required\"),\n});\n\nexport async function POST(request: Request) {\n  try {\n    const body = await request.json();\n    const validation = loginSchema.safeParse(body);\n\n    if (!validation.success) {\n      return NextResponse.json({ error: \"Invalid input\", details: validation.error.flatten() }, { status: 400 });\n    }\n\n    const { email, password } = validation.data;\n\n    // Find the user by email\n    const user = await prisma.user.findUnique({\n      where: { email },\n    });\n\n    if (!user) {\n      return NextResponse.json({ error: \"Invalid credentials\" }, { status: 401 });\n    }\n\n    // Compare the provided password with the stored hash\n    const isPasswordValid = await bcrypt.compare(password, user.passwordHash);\n\n    if (!isPasswordValid) {\n      return NextResponse.json({ error: \"Invalid credentials\" }, { status: 401 });\n    }\n\n    // Create the JWT payload\n    const payload = {\n      userId: user.id,\n      orgId: user.orgId,\n      role: user.role,\n      storeIds: user.storeIds,\n    };\n\n    // Sign the JWT\n    const secret = process.env.JWT_SECRET;\n    if (!secret) {\n      throw new Error(\"JWT_SECRET is not defined in environment variables\");\n    }\n\n    const token = jwt.sign(payload, secret, {\n      expiresIn: '1d', // Token expires in 1 day\n    });\n\n    // Omit passwordHash from the user object in the response\n    const { passwordHash: _, ...userWithoutPassword } = user;\n\n    return NextResponse.json({\n      token,\n      user: userWithoutPassword,\n    }, { status: 200 });\n\n  } catch (error) {\n    console.error(\"Login Error:\", error);\n    return NextResponse.json({ error: \"An internal server error occurred\" }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":"AAAA,kCAAkC;;;;AAClC;AACA;AACA;AACA;AACA;;;;;;AAEA,+BAA+B;AAC/B,MAAM,cAAc,+KAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IAC3B,OAAO,+KAAA,CAAA,IAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,UAAU,+KAAA,CAAA,IAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;AAC9B;AAEO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,aAAa,YAAY,SAAS,CAAC;QAEzC,IAAI,CAAC,WAAW,OAAO,EAAE;YACvB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;gBAAiB,SAAS,WAAW,KAAK,CAAC,OAAO;YAAG,GAAG;gBAAE,QAAQ;YAAI;QAC1G;QAEA,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,WAAW,IAAI;QAE3C,yBAAyB;QACzB,MAAM,OAAO,MAAM,+GAAA,CAAA,UAAM,CAAC,IAAI,CAAC,UAAU,CAAC;YACxC,OAAO;gBAAE;YAAM;QACjB;QAEA,IAAI,CAAC,MAAM;YACT,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC3E;QAEA,qDAAqD;QACrD,MAAM,kBAAkB,MAAM,oIAAO,OAAO,CAAC,UAAU,KAAK,YAAY;QAExE,IAAI,CAAC,iBAAiB;YACpB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC3E;QAEA,yBAAyB;QACzB,MAAM,UAAU;YACd,QAAQ,KAAK,EAAE;YACf,OAAO,KAAK,KAAK;YACjB,MAAM,KAAK,IAAI;YACf,UAAU,KAAK,QAAQ;QACzB;QAEA,eAAe;QACf,MAAM,SAAS,QAAQ,GAAG,CAAC,UAAU;QACrC,IAAI,CAAC,QAAQ;YACX,MAAM,IAAI,MAAM;QAClB;QAEA,MAAM,QAAQ,uIAAA,CAAA,UAAG,CAAC,IAAI,CAAC,SAAS,QAAQ;YACtC,WAAW;QACb;QAEA,yDAAyD;QACzD,MAAM,EAAE,cAAc,CAAC,EAAE,GAAG,qBAAqB,GAAG;QAEpD,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB;YACA,MAAM;QACR,GAAG;YAAE,QAAQ;QAAI;IAEnB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAoC,GAAG;YAAE,QAAQ;QAAI;IACzF;AACF"}},
    {"offset": {"line": 195, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}